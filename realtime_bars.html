<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>TWS API v9.72+: Real Time Bars</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="https://www.interactivebrokers.com/favicon.ico" rel="shortcut icon">
<script>
$(document).ready(function(){
		var picked=getCookie("picked");
		if (picked != "") {
			if (!$(this).hasClass("active")) {
				var tabNum = $(this).index();
				var nthChild = picked;
				$("ul#tabs li.active").removeClass("active");
				$(this).addClass("active");
				$("ul#tab li.active").removeClass("active");
				$("ul#tab li:nth-child("+nthChild+")").addClass("active");
				$("ul#tabs li:nth-child("+nthChild+")").addClass("active");
				setCookie("picked", nthChild, 1);
			}
		}
		$("ul#tabs li").click(function(e){
			if (!$(this).hasClass("active")) {
			var tabNum = $(this).index();
			var nthChild = tabNum+1;
			$("ul#tabs li.active").removeClass("active");
			$(this).addClass("active");
			$("ul#tab li.active").removeClass("active");
			$("ul#tab li:nth-child("+nthChild+")").addClass("active");
			setCookie("picked", nthChild, 1);
		}
    });
});
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
} 
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
} 
function checkCookie() {
    var picked=getCookie("picked");
    if (picked != "") {
        alert("Welcome again " + picked);
    }else{
        //username = prompt("Please enter your name:", "");
        if (picked != "" && picked != null) {
            setCookie("picked", 1, 365);
        }
    }
}
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ib_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></a></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li><li>Python</li></ul>
  </td>
  <td><a href="https://www.interactivebrokers.com/en/index.php?f=customerService&p=email" style="color:#C7C7C7;font-weight:bold;padding: 0 0 0 1em;">Contact us</a></td>
  <!--BEGIN GCS_SEARCHBOX-->
  <td style="position: absolute; right: 0;">
   <div id="google-custom-search" align="right" style="vertical-align: top;">
   <script>
  (function() {
    var cx = '002885114636493240026:q6smajphkxq';
	var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
	</script>
	<gcse:search newWindow="false" enableHistory="true"></gcse:search>
   </div>
   </td>
  <!--END !GCS_SEARCHBOX-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('realtime_bars.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Real Time Bars </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Real time and historical data functionality is combined through the <a class="el" href="classIBApi_1_1EClient.html#a644a8d918f3108a3817e8672b9782e67">IBApi.EClient.reqRealTimeBars</a> request. reqRealTimeBars will create an active subscription that will return a single bar in real time every five seconds that has the OHLC values over that period. reqRealTimeBars can only be used with a bar size of 5 seconds.</p>
<p><b>Important:</b> real time bars subscriptions combine the limitations of both, top and historical market data. Make sure you observe <a class="el" href="market_data.html#market_lines">Market Data Lines</a> and <a class="el" href="historical_limitations.html#pacing_violations">Pacing Violations for Small Bars (30 secs or less)</a>. For example, no more than 60 <b>*new*</b> requests for real time bars can be made in 10 minutes, and the total number of active active subscriptions of all types cannot exceed the maximum allowed market data lines for the user.</p>
<h1><a class="anchor" id="rt_bars_req"></a>
Requesting</h1>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.reqRealTimeBars(3001, ContractSamples.EurGbpFx(), 5, <span class="stringliteral">&quot;MIDPOINT&quot;</span>, <span class="keyword">true</span>, null);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.reqRealTimeBars(3001, ContractSamples.EurGbpFx(), 5, <span class="stringliteral">&quot;MIDPOINT&quot;</span>, <span class="keyword">true</span>, null);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.reqRealTimeBars(3001, ContractSamples.EurGbpFx(), 5, &quot;MIDPOINT&quot;, True, Nothing)</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;reqRealTimeBars(3001, ContractSamples::EurGbpFx(), 5, <span class="stringliteral">&quot;MIDPOINT&quot;</span>, <span class="keyword">true</span>, TagValueListSPtr());</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        self.reqRealTimeBars(3101, ContractSamples.USStockAtSmart(), 5, <span class="stringliteral">&quot;MIDPOINT&quot;</span>, <span class="keyword">True</span>, [])</div><div class="line">        self.reqRealTimeBars(3001, ContractSamples.EurGbpFx(), 5, <span class="stringliteral">&quot;MIDPOINT&quot;</span>, <span class="keyword">True</span>, [])</div></div><!-- fragment -->  </li>
</ul>
<ul>
<li>To receive volume, VWAP, or trade count data, it is necessary to specify whatToShow as TRADES.</li>
<li>It may be necessary to remake real time bars subscriptions after the IB server reset or between trading sessions.</li>
</ul>
<h1><a class="anchor" id="rt_bars_rec"></a>
Receiving</h1>
<p>Once invoked, historical data bars of five seconds will start being delivered through the <a class="el" href="interfaceIBApi_1_1EWrapper.html#ac23fa61ac0221a489ecd4566d1b320fe">IBApi.EWrapper.realtimeBar</a> callback:</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl : EWrapper </div><div class="line">    {</div></div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> realtimeBar(<span class="keywordtype">int</span> reqId, <span class="keywordtype">long</span> time, <span class="keywordtype">double</span> open, <span class="keywordtype">double</span> high, <span class="keywordtype">double</span> low, <span class="keywordtype">double</span> close, <span class="keywordtype">long</span> volume, <span class="keywordtype">double</span> WAP, <span class="keywordtype">int</span> count)</div><div class="line">        {</div><div class="line">            Console.WriteLine(<span class="stringliteral">&quot;RealTimeBars. &quot;</span> + reqId + <span class="stringliteral">&quot; - Time: &quot;</span> + time + <span class="stringliteral">&quot;, Open: &quot;</span> + open + <span class="stringliteral">&quot;, High: &quot;</span> + high + <span class="stringliteral">&quot;, Low: &quot;</span> + low + <span class="stringliteral">&quot;, Close: &quot;</span> + close + <span class="stringliteral">&quot;, Volume: &quot;</span> + volume + <span class="stringliteral">&quot;, Count: &quot;</span> + count + <span class="stringliteral">&quot;, WAP: &quot;</span> + WAP);</div><div class="line">        }</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl <span class="keyword">implements</span> EWrapper {</div></div><!-- fragment --> ... <div class="fragment"><div class="line">    @Override</div><div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> realtimeBar(<span class="keywordtype">int</span> reqId, <span class="keywordtype">long</span> time, <span class="keywordtype">double</span> open, <span class="keywordtype">double</span> high,</div><div class="line">            <span class="keywordtype">double</span> low, <span class="keywordtype">double</span> close, <span class="keywordtype">long</span> volume, <span class="keywordtype">double</span> wap, <span class="keywordtype">int</span> count) {</div><div class="line">        <a class="code" href="namespaceSystem.html">System</a>.out.println(<span class="stringliteral">&quot;RealTimeBars. &quot;</span> + reqId + <span class="stringliteral">&quot; - Time: &quot;</span> + time + <span class="stringliteral">&quot;, Open: &quot;</span> + open + <span class="stringliteral">&quot;, High: &quot;</span> + high + <span class="stringliteral">&quot;, Low: &quot;</span> + low + <span class="stringliteral">&quot;, Close: &quot;</span> + close + <span class="stringliteral">&quot;, Volume: &quot;</span> + volume + <span class="stringliteral">&quot;, Count: &quot;</span> + count + <span class="stringliteral">&quot;, WAP: &quot;</span> + wap);</div><div class="line">    }</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Public Class EWrapperImpl</div><div class="line">        Implements EWrapper</div></div><!-- fragment --> ... <div class="fragment"><div class="line">        Public Sub realtimeBar(reqId As Integer, time As Long, open As Double, high As Double, low As Double, close As Double, volume As Long, WAP As Double, count As Integer) Implements IBApi.EWrapper.realtimeBar</div><div class="line">            Console.WriteLine(&quot;RealTimeBars. &quot; &amp; reqId &amp; &quot; - Time: &quot; &amp; time &amp; &quot;, Open: &quot; &amp; open &amp; &quot;, High: &quot; &amp; high &amp; &quot;, Low: &quot; &amp; low &amp; &quot;, Close: &quot; &amp;</div><div class="line">        close &amp; &quot;, Volume: &quot; &amp; volume &amp; &quot;, Count: &quot; &amp; count &amp; &quot;, WAP: &quot; &amp; WAP)</div><div class="line">        End Sub</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestCppClient : <span class="keyword">public</span> EWrapper</div><div class="line">{</div></div><!-- fragment --> ... <div class="fragment"><div class="line"><span class="keywordtype">void</span> TestCppClient::realtimeBar(TickerId reqId, <span class="keywordtype">long</span> time, <span class="keywordtype">double</span> open, <span class="keywordtype">double</span> high, <span class="keywordtype">double</span> low, <span class="keywordtype">double</span> close,</div><div class="line">                                <span class="keywordtype">long</span> volume, <span class="keywordtype">double</span> wap, <span class="keywordtype">int</span> count) {</div><div class="line">    printf( <span class="stringliteral">&quot;RealTimeBars. %ld - Time: %ld, Open: %g, High: %g, Low: %g, Close: %g, Volume: %ld, Count: %d, WAP: %g\n&quot;</span>, reqId, time, open, high, low, close, volume, count, wap);</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestWrapper(wrapper.EWrapper):</div></div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="keyword">def </span>realtimeBar(self, reqId:TickerId, time:int, open:float, high:float, low:float, close:float, volume:int, wap:float, count:int):</div><div class="line">        super().realtimeBar(reqId, time, open, high, low, close, volume, wap, count)</div><div class="line">        print(<span class="stringliteral">&quot;RealTimeBars. &quot;</span>, reqId, <span class="stringliteral">&quot;: time &quot;</span>, time, <span class="stringliteral">&quot;, open: &quot;</span>,open, <span class="stringliteral">&quot;, high: &quot;</span>, high, <span class="stringliteral">&quot;, low: &quot;</span>, low, <span class="stringliteral">&quot;, close: &quot;</span>, close, <span class="stringliteral">&quot;, volume: &quot;</span>, volume, <span class="stringliteral">&quot;, wap: &quot;</span>, wap, <span class="stringliteral">&quot;, count: &quot;</span>, count)</div></div><!-- fragment -->  </li>
</ul>
<p>-Volume for US stocks has a multiplier of 100</p>
<h1><a class="anchor" id="rt_bars_cancel"></a>
Canceling</h1>
<p>To cancel an active request simply invoke <a class="el" href="classIBApi_1_1EClient.html#a472bdf9a30d1079e03400d8d38cfb634">IBApi.EClient.cancelRealTimeBars</a></p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.cancelRealTimeBars(3001);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.cancelRealTimeBars(3001);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.cancelRealTimeBars(3001)</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;cancelRealTimeBars(3001);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        self.cancelRealTimeBars(3101)</div><div class="line">        self.cancelRealTimeBars(3001)</div></div><!-- fragment -->  </li>
</ul>
<p><br />
<br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">This website uses cookies. By navigating through it you agree to the use of cookies. Copyright Interactive Brokers 2016 </li>
  </ul>
</div>
<!--BEGIN GCS_SEARCHBOX-->
<style type='text/css'>
	.gsc-control-cse{
		font family: Arial, sans-serif;
		border-color: #000100;
		background-color: #000000;
		width:260px;
		height: 20px;
		padding-top: 6px;
	}
	input.gsc-search-button {
		background-color: #6D1800;
		color: #fff;
		cursor: pointer;
	}
	input.gsc-search-button:hover {
		background-color: #A02200;
	}
	td.gsc-clear-button {
		position: relative;
		right: 85px;
	}
  }
</style>
<!--END GCS_SEARCHBOX-->
</body>
</html>
