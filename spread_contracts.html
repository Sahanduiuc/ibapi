<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>TWS API v9.72+: Spreads</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="https://www.interactivebrokers.com/favicon.ico" rel="shortcut icon">
<script>
$(document).ready(function(){
		var picked=getCookie("picked");
		if (picked != "") {
			if (!$(this).hasClass("active")) {
				var tabNum = $(this).index();
				var nthChild = picked;
				$("ul#tabs li.active").removeClass("active");
				$(this).addClass("active");
				$("ul#tab li.active").removeClass("active");
				$("ul#tab li:nth-child("+nthChild+")").addClass("active");
				$("ul#tabs li:nth-child("+nthChild+")").addClass("active");
				setCookie("picked", nthChild, 1);
			}
		}
		$("ul#tabs li").click(function(e){
			if (!$(this).hasClass("active")) {
			var tabNum = $(this).index();
			var nthChild = tabNum+1;
			$("ul#tabs li.active").removeClass("active");
			$(this).addClass("active");
			$("ul#tab li.active").removeClass("active");
			$("ul#tab li:nth-child("+nthChild+")").addClass("active");
			setCookie("picked", nthChild, 1);
		}
    });
});
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
} 
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
} 
function checkCookie() {
    var picked=getCookie("picked");
    if (picked != "") {
        alert("Welcome again " + picked);
    }else{
        //username = prompt("Please enter your name:", "");
        if (picked != "" && picked != null) {
            setCookie("picked", 1, 365);
        }
    }
}
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ib_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></a></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li><li>Python</li></ul>
  </td>
  <td><a href="https://www.interactivebrokers.com/en/index.php?f=customerService&p=email" style="color:#C7C7C7;font-weight:bold;padding: 0 0 0 1em;">Contact us</a></td>
  <!--BEGIN GCS_SEARCHBOX-->
  <td style="position: absolute; right: 0;">
   <div id="google-custom-search" align="right" style="vertical-align: top;">
   <script>
  (function() {
    var cx = '015239726745168389685:6_uymb577ei';
	var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
	</script>
	<gcse:search newWindow="false" enableHistory="true"></gcse:search>
   </div>
   </td>
  <!--END !GCS_SEARCHBOX-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('spread_contracts.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Spreads </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Spread contracts, also known as combos or combinations, combine two or more instruments. To define a combination contract it is required to know the conId of the <a class="el" href="classIBApi_1_1Contract.html">IBApi.Contract</a> in question. The conId of an instrument can easily be obtained via the <a class="el" href="classIBApi_1_1EClient.html#ade440c6db838b548594981d800ea5ca9">IBApi.EClientSocket.reqContractDetails</a> request.</p>
<p>The spread contract's symbol can be either the symbol of one of the contract legs or, for two-legged combinations the symbols of both legs separated by a comma as shown in the examples below.</p>
<h1><a class="anchor" id="bag_stk"></a>
Stock Spread</h1>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;IBKR,MCD&quot;</span>;</div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;USD&quot;</span>;</div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;SMART&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg1.ConId = 43645865;<span class="comment">//IBKR STK</span></div>
<div class="line">            leg1.Ratio = 1;</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;SMART&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg2.ConId = 9408;<span class="comment">//MCD STK</span></div>
<div class="line">            leg2.Ratio = 1;</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;SMART&quot;</span>;</div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = <span class="keyword">new</span> List&lt;ComboLeg&gt;();</div>
<div class="line">            contract.ComboLegs.Add(leg1);</div>
<div class="line">            contract.ComboLegs.Add(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">        contract.symbol(<span class="stringliteral">&quot;MCD&quot;</span>);</div>
<div class="line">        contract.secType(<span class="stringliteral">&quot;BAG&quot;</span>);</div>
<div class="line">        contract.currency(<span class="stringliteral">&quot;USD&quot;</span>);</div>
<div class="line">        contract.exchange(<span class="stringliteral">&quot;SMART&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">        ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line"></div>
<div class="line">        List&lt;ComboLeg&gt; addAllLegs = <span class="keyword">new</span> ArrayList&lt;&gt;();</div>
<div class="line"></div>
<div class="line">        leg1.conid(43645865);<span class="comment">//IBKR STK</span></div>
<div class="line">        leg1.ratio(1);</div>
<div class="line">        leg1.action(<span class="stringliteral">&quot;BUY&quot;</span>);</div>
<div class="line">        leg1.exchange(<span class="stringliteral">&quot;SMART&quot;</span>);</div>
<div class="line"></div>
<div class="line">        leg2.conid(9408);<span class="comment">//MCD STK</span></div>
<div class="line">        leg2.ratio(1);</div>
<div class="line">        leg2.action(<span class="stringliteral">&quot;SELL&quot;</span>);</div>
<div class="line">        leg2.exchange(<span class="stringliteral">&quot;SMART&quot;</span>);</div>
<div class="line"></div>
<div class="line">        addAllLegs.add(leg1);</div>
<div class="line">        addAllLegs.add(leg2);</div>
<div class="line">        </div>
<div class="line">        contract.comboLegs(addAllLegs);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">            Dim contract As Contract = New Contract</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;MCD&quot;</span></div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;USD&quot;</span></div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;SMART&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg1 As ComboLeg = New ComboLeg</div>
<div class="line">            leg1.ConId = 43645865</div>
<div class="line">            leg1.Ratio = 1</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;SMART&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg2 As ComboLeg = New ComboLeg</div>
<div class="line">            leg2.ConId = 9408</div>
<div class="line">            leg2.Ratio = 1</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;SMART&quot;</span></div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = New List(Of ComboLeg)</div>
<div class="line">            contract.ComboLegs.Add(leg1)</div>
<div class="line">            contract.ComboLegs.Add(leg2)</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Contract contract;</div>
<div class="line">    contract.symbol = <span class="stringliteral">&quot;MCD&quot;</span>;</div>
<div class="line">    contract.secType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">    contract.currency = <span class="stringliteral">&quot;USD&quot;</span>;</div>
<div class="line">    contract.exchange = <span class="stringliteral">&quot;SMART&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg1(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg1-&gt;conId = 43645865;</div>
<div class="line">    leg1-&gt;action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">    leg1-&gt;ratio = 1;</div>
<div class="line">    leg1-&gt;exchange = <span class="stringliteral">&quot;SMART&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg2(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg2-&gt;conId = 9408;</div>
<div class="line">    leg2-&gt;action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">    leg2-&gt;ratio = 1;</div>
<div class="line">    leg2-&gt;exchange = <span class="stringliteral">&quot;SMART&quot;</span>;</div>
<div class="line"></div>
<div class="line">    contract.comboLegs.reset(<span class="keyword">new</span> Contract::ComboLegList());</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg1);</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        contract = Contract()</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        contract.symbol = <span class="stringliteral">&quot;IBKR,MCD&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        contract.secType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        contract.currency = <span class="stringliteral">&quot;USD&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        contract.exchange = <span class="stringliteral">&quot;SMART&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        leg1 = ComboLeg()</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        leg1.conId = 43645865<span class="comment">#IBKR STK</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        leg1.ratio = 1</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        leg1.action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        leg1.exchange = <span class="stringliteral">&quot;SMART&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        leg2 = ComboLeg()</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        leg2.conId = 9408<span class="comment">#MCD STK</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        leg2.ratio = 1</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        leg2.action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        leg2.exchange = <span class="stringliteral">&quot;SMART&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        contract.comboLegs = []</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        contract.comboLegs.append(leg1)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        contract.comboLegs.append(leg2)</div>
</div><!-- fragment -->  </li>
</ul>
<p><b>Note:</b> EFPs are simply defined as a bag contract of stock and corresponding SSF with a ratio of 100:1.</p>
<h1><a class="anchor" id="bag_opt"></a>
Options Spread</h1>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;DBK&quot;</span>;</div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;EUR&quot;</span>;</div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;DTB&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg1.ConId = 197397509;<span class="comment">//DBK JUN 15 &#39;18 C</span></div>
<div class="line">            leg1.Ratio = 1;</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;DTB&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg2.ConId = 197397584;<span class="comment">//DBK JUN 15 &#39;18 P</span></div>
<div class="line">            leg2.Ratio = 1;</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;DTB&quot;</span>;</div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = <span class="keyword">new</span> List&lt;ComboLeg&gt;();</div>
<div class="line">            contract.ComboLegs.Add(leg1);</div>
<div class="line">            contract.ComboLegs.Add(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">        contract.symbol(<span class="stringliteral">&quot;DBK&quot;</span>);</div>
<div class="line">        contract.secType(<span class="stringliteral">&quot;BAG&quot;</span>);</div>
<div class="line">        contract.currency(<span class="stringliteral">&quot;EUR&quot;</span>);</div>
<div class="line">        contract.exchange(<span class="stringliteral">&quot;DTB&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">        ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line"></div>
<div class="line">        List&lt;ComboLeg&gt; addAllLegs = <span class="keyword">new</span> ArrayList&lt;&gt;();</div>
<div class="line"></div>
<div class="line">        leg1.conid(197397509);<span class="comment">//DBK JUN 15 &#39;18 C</span></div>
<div class="line">        leg1.ratio(1);</div>
<div class="line">        leg1.action(<span class="stringliteral">&quot;BUY&quot;</span>);</div>
<div class="line">        leg1.exchange(<span class="stringliteral">&quot;DTB&quot;</span>);</div>
<div class="line"></div>
<div class="line">        leg2.conid(197397584);<span class="comment">//DBK JUN 15 &#39;18 P</span></div>
<div class="line">        leg2.ratio(1);</div>
<div class="line">        leg2.action(<span class="stringliteral">&quot;SELL&quot;</span>);</div>
<div class="line">        leg2.exchange(<span class="stringliteral">&quot;DTB&quot;</span>);</div>
<div class="line"></div>
<div class="line">        addAllLegs.add(leg1);</div>
<div class="line">        addAllLegs.add(leg2);</div>
<div class="line">        </div>
<div class="line">        contract.comboLegs(addAllLegs);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">            Dim contract As Contract = New Contract</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;DBK&quot;</span></div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;EUR&quot;</span></div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;DTB&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg1 As ComboLeg = New ComboLeg</div>
<div class="line">            leg1.ConId = 197397509 <span class="stringliteral">&#39;DBK JUN 15 &#39;</span>18 C</div>
<div class="line">            leg1.Ratio = 1</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;DTB&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg2 As ComboLeg = New ComboLeg</div>
<div class="line">            leg2.ConId = 197397584 <span class="stringliteral">&#39;DBK JUN 15 &#39;</span>18 P</div>
<div class="line">            leg2.Ratio = 1</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;DTB&quot;</span></div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = New List(Of ComboLeg)</div>
<div class="line">            contract.ComboLegs.Add(leg1)</div>
<div class="line">            contract.ComboLegs.Add(leg2)</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Contract contract;</div>
<div class="line">    contract.symbol = <span class="stringliteral">&quot;DBK&quot;</span>;</div>
<div class="line">    contract.secType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">    contract.currency = <span class="stringliteral">&quot;EUR&quot;</span>;</div>
<div class="line">    contract.exchange = <span class="stringliteral">&quot;DTB&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg1(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg1-&gt;conId = 197397509;</div>
<div class="line">    leg1-&gt;action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">    leg1-&gt;ratio = 1;</div>
<div class="line">    leg1-&gt;exchange = <span class="stringliteral">&quot;DTB&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg2(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg2-&gt;conId = 197397584;</div>
<div class="line">    leg2-&gt;action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">    leg2-&gt;ratio = 1;</div>
<div class="line">    leg2-&gt;exchange = <span class="stringliteral">&quot;DTB&quot;</span>;</div>
<div class="line"></div>
<div class="line">    contract.comboLegs.reset(<span class="keyword">new</span> Contract::ComboLegList());</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg1);</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        contract = Contract()</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        contract.symbol = <span class="stringliteral">&quot;DBK&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        contract.secType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        contract.currency = <span class="stringliteral">&quot;EUR&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        contract.exchange = <span class="stringliteral">&quot;DTB&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        leg1 = ComboLeg()</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        leg1.conId = 197397509 <span class="comment">#DBK JUN 15 2018 C</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        leg1.ratio = 1</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        leg1.action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        leg1.exchange = <span class="stringliteral">&quot;DTB&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        leg2 = ComboLeg()</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        leg2.conId = 197397584  <span class="comment">#DBK JUN 15 2018 P</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        leg2.ratio = 1</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        leg2.action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        leg2.exchange = <span class="stringliteral">&quot;DTB&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        contract.comboLegs = []</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        contract.comboLegs.append(leg1)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        contract.comboLegs.append(leg2)</div>
</div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="bag_fut"></a>
Guaranteed Futures Spread</h1>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;VIX&quot;</span>;</div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;USD&quot;</span>;</div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;CFE&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg1.ConId = 195538625;<span class="comment">//VIX FUT 20160217</span></div>
<div class="line">            leg1.Ratio = 1;</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;CFE&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg2.ConId = 197436571;<span class="comment">//VIX FUT 20160316</span></div>
<div class="line">            leg2.Ratio = 1;</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;CFE&quot;</span>;</div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = <span class="keyword">new</span> List&lt;ComboLeg&gt;();</div>
<div class="line">            contract.ComboLegs.Add(leg1);</div>
<div class="line">            contract.ComboLegs.Add(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">        contract.symbol(<span class="stringliteral">&quot;VIX&quot;</span>);</div>
<div class="line">        contract.secType(<span class="stringliteral">&quot;BAG&quot;</span>);</div>
<div class="line">        contract.currency(<span class="stringliteral">&quot;USD&quot;</span>);</div>
<div class="line">        contract.exchange(<span class="stringliteral">&quot;CFE&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">        ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line"></div>
<div class="line">        List&lt;ComboLeg&gt; addAllLegs = <span class="keyword">new</span> ArrayList&lt;&gt;();</div>
<div class="line"></div>
<div class="line">        leg1.conid(195538625);<span class="comment">//VIX FUT 20160217</span></div>
<div class="line">        leg1.ratio(1);</div>
<div class="line">        leg1.action(<span class="stringliteral">&quot;BUY&quot;</span>);</div>
<div class="line">        leg1.exchange(<span class="stringliteral">&quot;CFE&quot;</span>);</div>
<div class="line"></div>
<div class="line">        leg2.conid(197436571);<span class="comment">//VIX FUT 20160316</span></div>
<div class="line">        leg2.ratio(1);</div>
<div class="line">        leg2.action(<span class="stringliteral">&quot;SELL&quot;</span>);</div>
<div class="line">        leg2.exchange(<span class="stringliteral">&quot;CFE&quot;</span>);</div>
<div class="line"></div>
<div class="line">        addAllLegs.add(leg1);</div>
<div class="line">        addAllLegs.add(leg2);</div>
<div class="line">        </div>
<div class="line">        contract.comboLegs(addAllLegs);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">            Dim contract As Contract = New Contract</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;VIX&quot;</span></div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;USD&quot;</span></div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;CFE&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg1 As ComboLeg = New ComboLeg</div>
<div class="line">            leg1.ConId = 195538625</div>
<div class="line">            leg1.Ratio = 1</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;CFE&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg2 As ComboLeg = New ComboLeg</div>
<div class="line">            leg2.ConId = 197436571</div>
<div class="line">            leg2.Ratio = 1</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;CFE&quot;</span></div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = New List(Of ComboLeg)</div>
<div class="line">            contract.ComboLegs.Add(leg1)</div>
<div class="line">            contract.ComboLegs.Add(leg2)</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Contract contract;</div>
<div class="line">    contract.symbol = <span class="stringliteral">&quot;VIX&quot;</span>;</div>
<div class="line">    contract.secType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">    contract.currency = <span class="stringliteral">&quot;USD&quot;</span>;</div>
<div class="line">    contract.exchange = <span class="stringliteral">&quot;CFE&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg1(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg1-&gt;conId = 195538625;</div>
<div class="line">    leg1-&gt;action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">    leg1-&gt;ratio = 1;</div>
<div class="line">    leg1-&gt;exchange = <span class="stringliteral">&quot;CFE&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg2(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg2-&gt;conId = 197436571;</div>
<div class="line">    leg2-&gt;action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">    leg2-&gt;ratio = 1;</div>
<div class="line">    leg2-&gt;exchange = <span class="stringliteral">&quot;CFE&quot;</span>;</div>
<div class="line"></div>
<div class="line">    contract.comboLegs.reset(<span class="keyword">new</span> Contract::ComboLegList());</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg1);</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        contract = Contract()</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        contract.symbol = <span class="stringliteral">&quot;VIX&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        contract.secType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        contract.currency = <span class="stringliteral">&quot;USD&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        contract.exchange = <span class="stringliteral">&quot;CFE&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        leg1 = ComboLeg()</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        leg1.conId = 256038899 <span class="comment"># VIX FUT 201708</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        leg1.ratio = 1</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        leg1.action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        leg1.exchange = <span class="stringliteral">&quot;CFE&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        leg2 = ComboLeg()</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        leg2.conId = 260564703 <span class="comment"># VIX FUT 201709</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        leg2.ratio = 1</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        leg2.action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        leg2.exchange = <span class="stringliteral">&quot;CFE&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        contract.comboLegs = []</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        contract.comboLegs.append(leg1)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        contract.comboLegs.append(leg2)</div>
</div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="bag_smartfuture"></a>
Smart-Routed Futures Spread</h1>
<p>Futures spreads can also be defined as Smart-routed (non-guaranteed) combos. When placing an order for a non-guaranteed combo from the API, the non-guaranteed flag must be set to 1. Historical data for smart-routed futures spreads is generally available from the API with the requisite market data subscriptions.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;WTI&quot;</span>; <span class="comment">// WTI,COIL spread. Symbol can be defined as first leg symbol (&quot;WTI&quot;) or currency (&quot;USD&quot;).</span></div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;USD&quot;</span>;</div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;SMART&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg1.ConId = 55928698;<span class="comment">//WTI future June 2017</span></div>
<div class="line">            leg1.Ratio = 1;</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;IPE&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg2.ConId = 55850663;<span class="comment">//COIL future June 2017</span></div>
<div class="line">            leg2.Ratio = 1;</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;IPE&quot;</span>;</div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = <span class="keyword">new</span> List&lt;ComboLeg&gt;();</div>
<div class="line">            contract.ComboLegs.Add(leg1);</div>
<div class="line">            contract.ComboLegs.Add(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">        contract.symbol(<span class="stringliteral">&quot;WTI&quot;</span>);  <span class="comment">// WTI,COIL spread. Symbol can be defined as first leg symbol (&quot;WTI&quot;) or currency (&quot;USD&quot;).</span></div>
<div class="line">        contract.secType(<span class="stringliteral">&quot;BAG&quot;</span>);</div>
<div class="line">        contract.currency(<span class="stringliteral">&quot;USD&quot;</span>);</div>
<div class="line">        contract.exchange(<span class="stringliteral">&quot;SMART&quot;</span>); <span class="comment">// smart-routed rather than direct routed</span></div>
<div class="line"></div>
<div class="line">        ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">        ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line"></div>
<div class="line">        List&lt;ComboLeg&gt; addAllLegs = <span class="keyword">new</span> ArrayList&lt;&gt;();</div>
<div class="line"></div>
<div class="line">        leg1.conid(55928698);<span class="comment">// WTI future June 2017</span></div>
<div class="line">        leg1.ratio(1);</div>
<div class="line">        leg1.action(<span class="stringliteral">&quot;BUY&quot;</span>);</div>
<div class="line">        leg1.exchange(<span class="stringliteral">&quot;IPE&quot;</span>);</div>
<div class="line"></div>
<div class="line">        leg2.conid(55850663);<span class="comment">// COIL future June 2017</span></div>
<div class="line">        leg2.ratio(1);</div>
<div class="line">        leg2.action(<span class="stringliteral">&quot;SELL&quot;</span>);</div>
<div class="line">        leg2.exchange(<span class="stringliteral">&quot;IPE&quot;</span>);</div>
<div class="line"></div>
<div class="line">        addAllLegs.add(leg1);</div>
<div class="line">        addAllLegs.add(leg2);</div>
<div class="line"></div>
<div class="line">        contract.comboLegs(addAllLegs);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">            Dim contract As Contract = New Contract</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;WTI&quot;</span> <span class="stringliteral">&#39; WTI,COIL spread. Symbol can be defined as first leg symbol (&quot;WTI&quot;) or currency (&quot;USD&quot;)</span></div>
<div class="line"><span class="stringliteral">            contract.SecType = &quot;BAG&quot;</span></div>
<div class="line"><span class="stringliteral">            contract.Currency = &quot;USD&quot;</span></div>
<div class="line"><span class="stringliteral">            contract.Exchange = &quot;SMART&quot;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            Dim leg1 As ComboLeg = New ComboLeg</span></div>
<div class="line"><span class="stringliteral">            leg1.ConId = 55928698 &#39;</span> WTI future June 2017</div>
<div class="line">            leg1.Ratio = 1</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;IPE&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg2 As ComboLeg = New ComboLeg</div>
<div class="line">            leg2.ConId = 55850663 <span class="stringliteral">&#39; COIL future June 2017</span></div>
<div class="line"><span class="stringliteral">            leg2.Ratio = 1</span></div>
<div class="line"><span class="stringliteral">            leg2.Action = &quot;SELL&quot;</span></div>
<div class="line"><span class="stringliteral">            leg2.Exchange = &quot;IPE&quot;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            contract.ComboLegs = New List(Of ComboLeg)</span></div>
<div class="line"><span class="stringliteral">            contract.ComboLegs.Add(leg1)</span></div>
<div class="line"><span class="stringliteral">            contract.ComboLegs.Add(leg2)</span></div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Contract contract;</div>
<div class="line">    contract.symbol = <span class="stringliteral">&quot;WTI&quot;</span>; <span class="comment">// WTI,COIL spread. Symbol can be defined as first leg symbol (&quot;WTI&quot;) or currency (&quot;USD&quot;).</span></div>
<div class="line">    contract.secType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">    contract.currency = <span class="stringliteral">&quot;USD&quot;</span>;</div>
<div class="line">    contract.exchange = <span class="stringliteral">&quot;SMART&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg1(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg1-&gt;conId = 55928698; <span class="comment">// WTI future June 2017</span></div>
<div class="line">    leg1-&gt;action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">    leg1-&gt;ratio = 1;</div>
<div class="line">    leg1-&gt;exchange = <span class="stringliteral">&quot;IPE&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg2(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg2-&gt;conId = 55850663; <span class="comment">// COIL future June 2017</span></div>
<div class="line">    leg2-&gt;action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">    leg2-&gt;ratio = 1;</div>
<div class="line">    leg2-&gt;exchange = <span class="stringliteral">&quot;IPE&quot;</span>;</div>
<div class="line"></div>
<div class="line">    contract.comboLegs.reset(<span class="keyword">new</span> Contract::ComboLegList());</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg1);</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        contract = Contract()</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        contract.symbol = <span class="stringliteral">&quot;WTI&quot;</span> <span class="comment"># WTI,COIL spread. Symbol can be defined as first leg symbol (&quot;WTI&quot;) or currency (&quot;USD&quot;)</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        contract.secType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        contract.currency = <span class="stringliteral">&quot;USD&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        contract.exchange = <span class="stringliteral">&quot;SMART&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        leg1 = ComboLeg()</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        leg1.conId = 55928698 <span class="comment"># WTI future June 2017</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        leg1.ratio = 1</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        leg1.action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        leg1.exchange = <span class="stringliteral">&quot;IPE&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        leg2 = ComboLeg()</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        leg2.conId = 55850663 <span class="comment"># COIL future June 2017</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        leg2.ratio = 1</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        leg2.action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        leg2.exchange = <span class="stringliteral">&quot;IPE&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        contract.comboLegs = []</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        contract.comboLegs.append(leg1)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        contract.comboLegs.append(leg2)</div>
</div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="bag_intcmdfut"></a>
Inter-Commodity Futures</h1>
<p>For Inter-Commodity futures, the 'Local Symbol' field in TWS is used for the 'Symbol' field in the API contract definition, e.g. "CL.BZ". They are always guaranteed combos, which is the default in the API.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;CL.BZ&quot;</span>;</div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;USD&quot;</span>;</div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;NYMEX&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg1.ConId = 47207310; <span class="comment">//CL Dec&#39;16 @NYMEX</span></div>
<div class="line">            leg1.Ratio = 1;</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;NYMEX&quot;</span>;</div>
<div class="line"></div>
<div class="line">            ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">            leg2.ConId = 47195961; <span class="comment">//BZ Dec&#39;16 @NYMEX</span></div>
<div class="line">            leg2.Ratio = 1;</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;NYMEX&quot;</span>;</div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = <span class="keyword">new</span> List&lt;ComboLeg&gt;();</div>
<div class="line">            contract.ComboLegs.Add(leg1);</div>
<div class="line">            contract.ComboLegs.Add(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        Contract contract = <span class="keyword">new</span> Contract();</div>
<div class="line">        contract.symbol(<span class="stringliteral">&quot;CL.BZ&quot;</span>);</div>
<div class="line">        contract.secType(<span class="stringliteral">&quot;BAG&quot;</span>);</div>
<div class="line">        contract.currency(<span class="stringliteral">&quot;USD&quot;</span>);</div>
<div class="line">        contract.exchange(<span class="stringliteral">&quot;NYMEX&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        ComboLeg leg1 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line">        ComboLeg leg2 = <span class="keyword">new</span> ComboLeg();</div>
<div class="line"></div>
<div class="line">        List&lt;ComboLeg&gt; addAllLegs = <span class="keyword">new</span> ArrayList&lt;&gt;();</div>
<div class="line"></div>
<div class="line">        leg1.conid(47207310); <span class="comment">//CL Dec&#39;16 @NYMEX</span></div>
<div class="line">        leg1.ratio(1);</div>
<div class="line">        leg1.action(<span class="stringliteral">&quot;BUY&quot;</span>);</div>
<div class="line">        leg1.exchange(<span class="stringliteral">&quot;NYMEX&quot;</span>);</div>
<div class="line"></div>
<div class="line">        leg2.conid(47195961); <span class="comment">//BZ Dec&#39;16 @NYMEX</span></div>
<div class="line">        leg2.ratio(1);</div>
<div class="line">        leg2.action(<span class="stringliteral">&quot;SELL&quot;</span>);</div>
<div class="line">        leg2.exchange(<span class="stringliteral">&quot;NYMEX&quot;</span>);</div>
<div class="line"></div>
<div class="line">        addAllLegs.add(leg1);</div>
<div class="line">        addAllLegs.add(leg2);</div>
<div class="line">        </div>
<div class="line">        contract.comboLegs(addAllLegs);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">            Dim contract As Contract = New Contract</div>
<div class="line">            contract.Symbol = <span class="stringliteral">&quot;CL.BZ&quot;</span></div>
<div class="line">            contract.SecType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line">            contract.Currency = <span class="stringliteral">&quot;USD&quot;</span></div>
<div class="line">            contract.Exchange = <span class="stringliteral">&quot;NYMEX&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg1 As ComboLeg = New ComboLeg</div>
<div class="line">            leg1.ConId = 47207310 <span class="stringliteral">&#39; CL Dec&#39;</span>16 @NYMEX</div>
<div class="line">            leg1.Ratio = 1</div>
<div class="line">            leg1.Action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line">            leg1.Exchange = <span class="stringliteral">&quot;NYMEX&quot;</span></div>
<div class="line"></div>
<div class="line">            Dim leg2 As ComboLeg = New ComboLeg</div>
<div class="line">            leg2.ConId = 47195961 <span class="stringliteral">&#39; BZ Dec&#39;</span>16 @NYMEX</div>
<div class="line">            leg2.Ratio = 1</div>
<div class="line">            leg2.Action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line">            leg2.Exchange = <span class="stringliteral">&quot;NYMEX&quot;</span></div>
<div class="line"></div>
<div class="line">            contract.ComboLegs = New List(Of ComboLeg)</div>
<div class="line">            contract.ComboLegs.Add(leg1)</div>
<div class="line">            contract.ComboLegs.Add(leg2)</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Contract contract;</div>
<div class="line">    contract.symbol = <span class="stringliteral">&quot;CL.BZ&quot;</span>;</div>
<div class="line">    contract.secType = <span class="stringliteral">&quot;BAG&quot;</span>;</div>
<div class="line">    contract.currency = <span class="stringliteral">&quot;USD&quot;</span>;</div>
<div class="line">    contract.exchange = <span class="stringliteral">&quot;NYMEX&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg1(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg1-&gt;conId = 47207310; <span class="comment">//CL Dec&#39;16 @NYMEX</span></div>
<div class="line">    leg1-&gt;action = <span class="stringliteral">&quot;BUY&quot;</span>;</div>
<div class="line">    leg1-&gt;ratio = 1;</div>
<div class="line">    leg1-&gt;exchange = <span class="stringliteral">&quot;NYMEX&quot;</span>;</div>
<div class="line"></div>
<div class="line">    ComboLegSPtr leg2(<span class="keyword">new</span> ComboLeg);</div>
<div class="line">    leg2-&gt;conId = 47195961; <span class="comment">//BZ Dec&#39;16 @NYMEX</span></div>
<div class="line">    leg2-&gt;action = <span class="stringliteral">&quot;SELL&quot;</span>;</div>
<div class="line">    leg2-&gt;ratio = 1;</div>
<div class="line">    leg2-&gt;exchange = <span class="stringliteral">&quot;NYMEX&quot;</span>;</div>
<div class="line"></div>
<div class="line">    contract.comboLegs.reset(<span class="keyword">new</span> Contract::ComboLegList());</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg1);</div>
<div class="line">    contract.comboLegs-&gt;push_back(leg2);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        contract = Contract()</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        contract.symbol = <span class="stringliteral">&quot;CL.BZ&quot;</span> <span class="comment">#symbol is &#39;local symbol&#39; of intercommodity spread. </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        contract.secType = <span class="stringliteral">&quot;BAG&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        contract.currency = <span class="stringliteral">&quot;USD&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        contract.exchange = <span class="stringliteral">&quot;NYMEX&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        leg1 = ComboLeg()</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        leg1.conId = 47207310 <span class="comment">#CL Dec&#39;16 @NYMEX</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        leg1.ratio = 1</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        leg1.action = <span class="stringliteral">&quot;BUY&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        leg1.exchange = <span class="stringliteral">&quot;NYMEX&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        leg2 = ComboLeg()</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        leg2.conId = 47195961 <span class="comment">#BZ Dec&#39;16 @NYMEX</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        leg2.ratio = 1</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        leg2.action = <span class="stringliteral">&quot;SELL&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        leg2.exchange = <span class="stringliteral">&quot;NYMEX&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        contract.comboLegs = []</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        contract.comboLegs.append(leg1)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        contract.comboLegs.append(leg2)</div>
</div><!-- fragment -->  </li>
</ul>
<p><em>Please be mindful of the fact that inter-commodity spreads are offered by the exchange directly, and so they are direct-routed though the legs have different underlyings. Only real time, and not historical, data is offered for inter-commodity spread contracts through the API.</em></p>
<p><em>It is also possible in many cases to create a spread of the same future contracts in a inter-commodity spread which is smart-routed and non-guaranteed. Historical data for this spread would generally be available from the API. Also, historical data for expired spread contracts is not available in TWS or the API. </em></p>
<p><br/>
<br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">This website uses cookies. By navigating through it you agree to the use of cookies. Copyright Interactive Brokers 2016 </li>
  </ul>
</div>
<!--BEGIN GCS_SEARCHBOX-->
<style type='text/css'>
	.gsc-control-cse{
		font family: Arial, sans-serif;
		border-color: #000100;
		background-color: #000000;
		width:260px;
		height: 20px;
		padding-top: 6px;
	}
	input.gsc-search-button {
		background-color: #6D1800;
		color: #fff;
		cursor: pointer;
	}
	input.gsc-search-button:hover {
		background-color: #A02200;
	}
	td.gsc-clear-button {
		position: relative;
		right: 85px;
	}
  }
</style>
<!--END GCS_SEARCHBOX-->
</body>
</html>
