<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>TWS API v9.72+: RTD Server for Excel</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="https://www.interactivebrokers.com/favicon.ico" rel="shortcut icon">
<script>
$(document).ready(function(){
		var picked=getCookie("picked");
		if (picked != "") {
			if (!$(this).hasClass("active")) {
				var tabNum = $(this).index();
				var nthChild = picked;
				$("ul#tabs li.active").removeClass("active");
				$(this).addClass("active");
				$("ul#tab li.active").removeClass("active");
				$("ul#tab li:nth-child("+nthChild+")").addClass("active");
				$("ul#tabs li:nth-child("+nthChild+")").addClass("active");
				setCookie("picked", nthChild, 1);
			}
		}
		$("ul#tabs li").click(function(e){
			if (!$(this).hasClass("active")) {
			var tabNum = $(this).index();
			var nthChild = tabNum+1;
			$("ul#tabs li.active").removeClass("active");
			$(this).addClass("active");
			$("ul#tab li.active").removeClass("active");
			$("ul#tab li:nth-child("+nthChild+")").addClass("active");
			setCookie("picked", nthChild, 1);
		}
    });
});
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
} 
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
} 
function checkCookie() {
    var picked=getCookie("picked");
    if (picked != "") {
        alert("Welcome again " + picked);
    }else{
        //username = prompt("Please enter your name:", "");
        if (picked != "" && picked != null) {
            setCookie("picked", 1, 365);
        }
    }
}
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ib_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></a></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li><li>Python</li></ul>
  </td>
  <!--BEGIN SS360 SEARCH-->
  <td>
	<div id="site-search-360" align="right" style="padding-left: 1em;">
		<input id="searchBox" type="search" placeholder="Search..." />
		<input id="ss360SearchButton" type="submit" />
	</div>
  </td>
  <!--END SS360 SEARCH-->
  <div id="contact-us" align="right">
	<td><a href="https://www.interactivebrokers.com/en/index.php?f=customerService&p=email" style="color:#C7C7C7;font-weight:bold;padding: 0 0 0 1em;">Contact us</a></td>
  </div>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tws_rtd_server.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">RTD Server for Excel </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="rtd_introduction"></a>
Introduction</h1>
<p>TWS RTD Server API is a dynamic link library which allows user to request real-time market data from TWS via API using Microsoft Excel®. The TWS RTD Server API directly uses the C# API Client source, which connects to TWS via the socket. It allows displaying streaming live (or 15-minute delayed) market data in Excel by entering formulas into an Excel cell following a specific syntax.</p>
<p><b>Note: </b>At the current stage, only top-level market data is supported via TWS RTD Server API. No trading capability or other data types are supported. Both Delayed and Real-Time data are supported via TWS RTD Server API. <a class="el" href="market_data.html#market_subscriptions">Market Data Subscription</a> is required for requesting live streaming market data. <br/>
</p>
<h1><a class="anchor" id="rtd_what_you_will_need"></a>
What You Will Need</h1>
<h2><a class="anchor" id="rtd_req_env"></a>
- Windows Operating System</h2>
<p>Since the TWS RTD Server API technology directly refers to the C# API client source functions, it is supported on <a href="https://www.interactivebrokers.com/en/index.php?f=1658&amp;nhf=T" target="_blank">Windows Environment</a> only.</p>
<h2><a class="anchor" id="rtd_req_api"></a>
- API version 9.73.03+</h2>
<p>You need to download <a href="http://interactivebrokers.github.io/" target="_blank">IB API</a> Windows version 9.73.03 or higher and install on your computer. Once you have installed the API, you can verify the API Version by checking <em>C:\TWS API\API_VersionNum.txt</em> by default.</p>
<h2><a class="anchor" id="rtd_req_tws"></a>
- TWS (or IB Gateway) Build 963+</h2>
<p>By default, market data requests sent via TWS RTD Server will automatically request for all possible <a class="el" href="rtd_simple_syntax.html#rtd_simple_syntax_gen_ticks">Generic Tick Types</a>. There are several generic tick types being requested that are only supported in TWS 963 or higher. Sending any RTD market data request with default generic tick list to an old build of TWS will trigger a "TwsRtdServer error" indicating incorrect generic tick list is sent. Make sure a <a href="https://www.interactivebrokers.com/en/index.php?f=14099#tws-software" target="_blank">TWS builds 963+</a> is downloaded from IB website and kept running at the background for TWS RTD Server API to function properly.</p>
<h2><a class="anchor" id="rtd_req_socket"></a>
- Enable Socket Client in TWS (or IB Gateway)</h2>
<p>Since the TWS RTD Server API directly refers to the C# API source, RTD market data requests will be sent via the socket layer. Please make sure to <a class="el" href="initial_setup.html#enable_api">Enable ActiveX and Socket Client</a> settings in your TWS.</p>
<p>Please also be mindful of the socket port that you configure in your TWS API settings. The default socket port TWS will listen on is <b>7496</b> for a live session, and <b>7497</b> for a paper session. It is further discussed in section <a class="el" href="rtd_simple_syntax.html#rtd_simple_syntax_conn">Connection Parameters</a> that TWS RTD Server connects to port <b>7496</b> by default, and you are able to customize the port number to connect by specifying pre-defined <a class="el" href="rtd_simple_syntax.html#rtd_simple_syntax_conn">Connection Parameters</a> or using rtd_complex_syntax string "port=&lt;port&gt;". You can use any valid port for connection as you wish, and you just need to make sure that the port you are trying to connect to via the API is the same port your TWS is listening on.</p>
<h2><a class="anchor" id="rtd_req_excel"></a>
- Microsoft Excel®</h2>
<p>After installing the API, the pre-compiled RTD library file (located at <em>C:\TWS API\source\csharpclient\TwsRtdServer\bin\Release\TwsRtdServer.dll</em> by default) registered on your computer will be in 32-bit by default for API versions from 973.03 to 973.06. If you are using 64-bit Microsoft Excel, you would need to re-compile RTD server dll file into 64-bit and register the library by re-building the RTD source solution using Visual Studio. Please refer to the <a href="https://attendee.gotowebinar.com/register/7412660386944689921" target="_blank">TWS Excel APIs, featuring the RealTimeData Server</a> recorded webinar for more information. Beginning in API v973.07* it is expected that the API installer for RTD Server will be compatible with both 32 bit and 64 bit Excel (* expected version number).</p>
<h1><a class="anchor" id="rtd_syntax_headline"></a>
TWS RTD Server Formula Syntax</h1>
<p>Customer can request market data by entering the following formula with corresponding parameters into an Excel spreadsheet cell:</p>
<p><code class="rtd_formula"> =RTD(<b>ProgID</b>, <b>Server</b>, <b>String1</b>, <b>String2</b>, ...) </code></p>
<p>where</p>
<ul>
<li><b>ProgID</b> = "Tws.TwsRtdServerCtrl"</li>
<li><b>Server</b> = "" (empty string)</li>
<li><b>String1</b>, <b>String2</b>, ... is a list of strings representing <b>Ticker</b>, <b>Topic</b>, <b>Connection Parameters</b> or other <b>Complex Syntax</b> strings.</li>
</ul>
<p><em><b>Note: </b>TWS RTD Server API formula is <b>not</b> case-sensitive.</em></p>
<p>There are three ways to compose an RTD Formula:</p>
<ul>
<li><a class="el" href="rtd_simple_syntax.html">Simple Syntax</a></li>
<li><a class="el" href="rtd_complex_syntax.html">Complex Syntax</a></li>
<li><a class="el" href="rtd_mixed_syntax.html">Mixed Syntax</a></li>
</ul>
<h1><a class="anchor" id="rtd_examples_headline"></a>
Syntax Samples</h1>
<p>A resourceful <a class="el" href="rtd_examples.html">Syntax Samples</a> page is provided for demonstration of RTD formulas categorized by security type using different syntaxs.</p>
<ul>
<li><a class="el" href="rtd_examples.html#rtd_samples_fx">Forex Pairs</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_stk">Stocks</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_ind">Indexes</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_cfd">CFDs</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_fut">Futures</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_opt">Options</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_fop">Futures Options</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_bond">Bonds</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_fund">Mutual Funds</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_cmdty">Commodities</a></li>
<li><a class="el" href="rtd_examples.html#rtd_samples_spread">Spreads</a></li>
</ul>
<p>Besides reading through the written documentation, you can also watch the <a href="https://attendee.gotowebinar.com/register/7412660386944689921" target="_blank">TWS Excel APIs, featuring the RealTimeData Server</a> recorded webinar for a more interactive tutorial video.</p>
<h1><a class="anchor" id="rtd_message_limit"></a>
Outgoing message rate limit</h1>
<ul>
<li>It is important to keep in mind the 50 message/second API limit applies to RTD Server in the same way as other socket-based API technologies. So the Excel spreadsheet can send no more than 50 messages/second to TWS. Each subscription or cancellation request counts as 1 message (messages in the opposite direction are not included). So a spreadsheet can have hundreds of streaming tickers, but the subscriptions must be spread out over time so that no more than 50 new subscriptions are made per second, or the spreadsheet can become disconnected.</li>
</ul>
<h1><a class="anchor" id="rtd_throttle_headline"></a>
Change Data Refresh Rate</h1>
<ul>
<li><a class="el" href="rtd_throttle.html">Change Data Refresh Rate</a></li>
</ul>
<h1><a class="anchor" id="rtd_fqa_errors_headline"></a>
Troubleshooting Common Errors</h1>
<ul>
<li><a class="el" href="rtd_fqa_errors.html">Troubleshooting Common Errors</a></li>
</ul>
<p><br/>
<br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">This website uses cookies. By navigating through it you agree to the use of cookies. Copyright Interactive Brokers 2016 </li>
  </ul>
</div>
<!--BEGIN !SS360 SEARCH-->
<script>
var ss360Config = {
    /********* General *********/
    siteId: 'tws-api-doc',
    animationSpeed: 250,
    themeColor: '#A02424',
    showErrors: false,
    /********* Search Box *********/
    searchBoxSelector: '#searchBox',
    searchBoxStyle: {
        text: {
            color: '#ffffff',
            size: '12px',
        },
        background: {
            color: '#000000',
        },
        padding: '8px',        
        icon: {
            image: undefined,
        },
        border: {
            color: '#464646',
            radius: '7px',
        },
        button: {
            text: ' ',
            icon: 'magnifier'
        }
    },
    placeholder: 'Search...',
    searchButton: '#ss360SearchButton',
    /********* Search Suggestions *********/
    showSearchSuggestions: true,
    suggestionsStyle: {
        text: {
            color: '#333333',
        },
        background: {
            color: '#ffffff'
        },
        padding: '10px',
        distanceFromTop: '7px',
        border: {
            color: '#dddddd',
            radius: '7px',
        },
    },
    showImagesSuggestions: true,
    numSuggestions: 6,
    maxQuerySuggestions: 3,
    minChars: 3,
    highlight: true,
    /********* Search Results *********/
    searchResults: undefined,
    searchResultsCaption: 'We found #COUNT# results for your query "#QUERY#"',
    numResults: 50,
    navigation: 'top',
    highlightQueryTerms: true,
    showImagesResults: true,
    showResultLink: true,
    resultLinksOpenNewTab: false,
    queryCorrectionText: 'Did you mean "#CORRECTION#"?',
    noResultsText: 'Sorry, we have not found any matches for your query.',
    otherContentGroupName: 'Other',
    ignoreOtherContentGroup: false,
    moreResultsButton: undefined,
    moreResultsPagingSize: 50,
    groupResults: true,
    loader: {
        type: 'circle'
    }
}
</script>
<script src="https://sitesearch360.com/cdn/sitesearch360-v10.min.js"></script>
<!--END !SS360 SEARCH-->
</body>
</html>
