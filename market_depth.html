<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>TWS API v9.72+: Market Depth (Level II)</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="https://www.interactivebrokers.com/favicon.ico" rel="shortcut icon">
<script>
$(document).ready(function(){
		var picked=getCookie("picked");
		if (picked != "") {
			if (!$(this).hasClass("active")) {
				var tabNum = $(this).index();
				var nthChild = picked;
				$("ul#tabs li.active").removeClass("active");
				$(this).addClass("active");
				$("ul#tab li.active").removeClass("active");
				$("ul#tab li:nth-child("+nthChild+")").addClass("active");
				$("ul#tabs li:nth-child("+nthChild+")").addClass("active");
				setCookie("picked", nthChild, 1);
			}
		}
		$("ul#tabs li").click(function(e){
			if (!$(this).hasClass("active")) {
			var tabNum = $(this).index();
			var nthChild = tabNum+1;
			$("ul#tabs li.active").removeClass("active");
			$(this).addClass("active");
			$("ul#tab li.active").removeClass("active");
			$("ul#tab li:nth-child("+nthChild+")").addClass("active");
			setCookie("picked", nthChild, 1);
		}
    });
});
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
} 
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
} 
function checkCookie() {
    var picked=getCookie("picked");
    if (picked != "") {
        alert("Welcome again " + picked);
    }else{
        //username = prompt("Please enter your name:", "");
        if (picked != "" && picked != null) {
            setCookie("picked", 1, 365);
        }
    }
}
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ib_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></a></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li><li>Python</li></ul>
  </td>
  <td><a href="https://www.interactivebrokers.com/en/index.php?f=customerService&p=email" style="color:#C7C7C7;font-weight:bold;padding: 0 0 0 1em;">Contact us</a></td>
  <!--BEGIN GCS_SEARCHBOX-->
  <td style="position: absolute; right: 0;">
   <div id="google-custom-search" align="right" style="vertical-align: top;">
   <script>
  (function() {
    var cx = '002885114636493240026:q6smajphkxq';
	var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
	</script>
	<gcse:search newWindow="false" enableHistory="true"></gcse:search>
   </div>
   </td>
  <!--END !GCS_SEARCHBOX-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('market_depth.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Market Depth (Level II) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Market depth data, also known as level II, represent's an instrument's order book. Via the TWS API it is possible to obtain this information thanks to the <a class="el" href="classIBApi_1_1EClient.html#a7f2915171d0c150723e297be291beabb">IBApi.EClient.reqMarketDepth</a> function. Unlike <a class="el" href="top_data.html">Top Market Data (Level I)</a>, market depth data is sent without sampling nor filtering, however we cannot guarantee that every price quoted for a particular security will be displayed when you invoke <a class="el" href="classIBApi_1_1EClient.html#a7f2915171d0c150723e297be291beabb">IBApi.EClient.reqMarketDepth</a>. Market depth requests must be routed to a particular exchange - it is <b>not</b> possible to request a smart-routed aggregate quote as with level 1 data.</p>
<h1><a class="anchor" id="request"></a>
Requesting</h1>
<p>The <a class="el" href="classIBApi_1_1EClient.html#a7f2915171d0c150723e297be291beabb">IBApi.EClient.reqMarketDepth</a> method receives a request identifier (or ticker Id) with which to identify the incoming data, the <a class="el" href="classIBApi_1_1Contract.html">IBApi.Contract</a> for which we want to pull this information and the number of rows or depth level that is required. In case the market depth is smaller than the requested number of rows, the TWS will simply return the available entries.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.reqMarketDepth(2001, ContractSamples.EurGbpFx(), 5, null);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.reqMktDepth(2001, ContractSamples.EurGbpFx(), 5, null);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.reqMarketDepth(2001, ContractSamples.EurGbpFx(), 5, Nothing)</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;reqMktDepth(2001, ContractSamples::EurGbpFx(), 5, TagValueListSPtr());</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        self.reqMktDepth(2101, ContractSamples.USStock(), 5, [])</div><div class="line">        self.reqMktDepth(2001, ContractSamples.EurGbpFx(), 5, [])</div></div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="reqmktdepthexchanges"></a>
Exchanges supplying Market Makers</h1>
<p><b> This function is still under development </b></p>
<p>Market depth will be returned via the <a class="el" href="interfaceIBApi_1_1EWrapper.html#ab0d68c4cf7093f105095d72dd7e7a912">IBApi.EWrapper.updateMktDepth</a> and <a class="el" href="interfaceIBApi_1_1EWrapper.html#ad8afb71cd866b423a84555f500992968">IBApi.EWrapper.updateMktDepthL2</a> callback. The two functions differentiate in that, for exchanges have additional Market Makers than itself, market depth data will be relayed back through <a class="el" href="interfaceIBApi_1_1EWrapper.html#ad8afb71cd866b423a84555f500992968">IBApi.EWrapper.updateMktDepthL2</a>, otherwise <a class="el" href="interfaceIBApi_1_1EWrapper.html#ab0d68c4cf7093f105095d72dd7e7a912">IBApi.EWrapper.updateMktDepth</a>. For example, ARCA only has ARCA itself as a Market Maker. Therefore when requesting market depth data from ARCA, the data will be relayed back via <a class="el" href="interfaceIBApi_1_1EWrapper.html#ab0d68c4cf7093f105095d72dd7e7a912">IBApi.EWrapper.updateMktDepth</a>. On the other hand, exchange like ISLAND (ECN for NASDAQ) has additional Market Makers, such as Timberhill, so the data will be relayed back via <a class="el" href="interfaceIBApi_1_1EWrapper.html#ad8afb71cd866b423a84555f500992968">IBApi.EWrapper.updateMktDepthL2</a>, where the Market Maker information is directly available as a parameter of the call back function.</p>
<p>To check which market depth subscriptions provide market maker information, the function <a class="el" href="classIBApi_1_1EClient.html#a5c40b7bf20ba269530807b093dc51853" title="Requests venues for which market data is returned to updateMktDepthL2 (those with market makers) ...">IBApi::EClient::reqMktDepthExchanges</a> can be invoked.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.reqMktDepthExchanges();</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.reqMktDepthExchanges();</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.reqMktDepthExchanges()</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;reqMktDepthExchanges();</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        self.reqMktDepthExchanges()</div></div><!-- fragment -->  </li>
</ul>
<p>API 'Exchange' fields for which a market depth request would return market maker information and result in a callback to <a class="el" href="interfaceIBApi_1_1EWrapper.html#ad8afb71cd866b423a84555f500992968" title="Returns the order book. ">IBApi::EWrapper::updateMktDepthL2</a> will be indicated in the results from the <a class="el" href="interfaceIBApi_1_1EWrapper.html#aaf5ec42d517d013340e52c42209dcefe" title="called when receives Depth Market Data Descriptions ">IBApi::EWrapper::mktDepthExchanges</a> field by a 'True' value in the 'isL2' field:</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> mktDepthExchanges(DepthMktDataDescription[] depthMktDataDescriptions)</div><div class="line">        {</div><div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Market Depth Exchanges:&quot;</span>);</div><div class="line"></div><div class="line">            <span class="keywordflow">foreach</span> (var depthMktDataDescription <span class="keywordflow">in</span> depthMktDataDescriptions)</div><div class="line">            {</div><div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Depth Market Data Description: Exchange: {0}, Security Type: {1}, Listing Exch: {2}, Service Data Type: {3}, Agg Group: {4}&quot;</span>, </div><div class="line">                    depthMktDataDescription.Exchange, depthMktDataDescription.SecType, </div><div class="line">                    depthMktDataDescription.ListingExch, depthMktDataDescription.ServiceDataType,</div><div class="line">                    depthMktDataDescription.AggGroup != Int32.MaxValue ? depthMktDataDescription.AggGroup.ToString() : <span class="stringliteral">&quot;&quot;</span></div><div class="line">                    );</div><div class="line">            }</div><div class="line">        }</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    @Override</div><div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> mktDepthExchanges(DepthMktDataDescription[] depthMktDataDescriptions) {</div><div class="line">        <span class="keywordflow">for</span> (DepthMktDataDescription depthMktDataDescription : depthMktDataDescriptions) {</div><div class="line">            <a class="code" href="namespaceSystem.html">System</a>.out.println(<span class="stringliteral">&quot;Depth Mkt Data Description. Exchange: &quot;</span> + depthMktDataDescription.exchange() +</div><div class="line">            <span class="stringliteral">&quot;, ListingExch: &quot;</span> + depthMktDataDescription.listingExch() + </div><div class="line">            <span class="stringliteral">&quot;, SecType: &quot;</span> + depthMktDataDescription.secType() +</div><div class="line">            <span class="stringliteral">&quot;, ServiceDataType: &quot;</span> + depthMktDataDescription.serviceDataType() +</div><div class="line">            <span class="stringliteral">&quot;, AggGroup: &quot;</span> + depthMktDataDescription.aggGroup()</div><div class="line">            );</div><div class="line">        }</div><div class="line">    }</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        Public Sub mktDepthExchanges(depthMktDataDescriptions As DepthMktDataDescription()) Implements EWrapper.mktDepthExchanges</div><div class="line">            Console.WriteLine(&quot;Market Depth Exchanges:&quot;)</div><div class="line"></div><div class="line">            Dim aggGroup As String</div><div class="line"></div><div class="line">            For Each depthMktDataDescription In depthMktDataDescriptions</div><div class="line">                If depthMktDataDescription.AggGroup &lt;&gt; Integer.MaxValue Then</div><div class="line">                    aggGroup = depthMktDataDescription.AggGroup</div><div class="line">                Else</div><div class="line">                    aggGroup = &quot;&quot;</div><div class="line">                End If</div><div class="line"></div><div class="line">                Console.WriteLine(&quot;Depth Market Data Descriprion. Exchange: &quot; &amp; depthMktDataDescription.Exchange &amp;</div><div class="line">                                  &quot; Security Type: &quot; &amp; depthMktDataDescription.SecType &amp;</div><div class="line">                                  &quot; Listing Exch: &quot; &amp; depthMktDataDescription.ListingExch &amp;</div><div class="line">                                  &quot; Service Data Type: &quot; &amp; depthMktDataDescription.ServiceDataType &amp;</div><div class="line">                                  &quot;  Agg Group: &quot; &amp; aggGroup)</div><div class="line">            Next</div><div class="line">        End Sub</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> TestCppClient::mktDepthExchanges(<span class="keyword">const</span> std::vector&lt;DepthMktDataDescription&gt; &amp;depthMktDataDescriptions) {</div><div class="line">    printf(<span class="stringliteral">&quot;Mkt Depth Exchanges (%lu):\n&quot;</span>, depthMktDataDescriptions.size());</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; depthMktDataDescriptions.size(); i++) {</div><div class="line">        printf(<span class="stringliteral">&quot;Depth Mkt Data Description [%d] - exchange: %s secType: %s listingExch: %s serviceDataType: %s aggGroup: %s\n&quot;</span>, i, </div><div class="line">            depthMktDataDescriptions[i].exchange.c_str(), </div><div class="line">            depthMktDataDescriptions[i].secType.c_str(), </div><div class="line">            depthMktDataDescriptions[i].listingExch.c_str(), </div><div class="line">            depthMktDataDescriptions[i].serviceDataType.c_str(), </div><div class="line">            depthMktDataDescriptions[i].aggGroup != INT_MAX ? std::to_string(depthMktDataDescriptions[i].aggGroup).c_str() : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    <span class="keyword">def </span>mktDepthExchanges(self, depthMktDataDescriptions:ListOfDepthExchanges):</div><div class="line">        super().mktDepthExchanges(depthMktDataDescriptions)</div><div class="line">        print(<span class="stringliteral">&quot;mktDepthExchanges:&quot;</span>)</div><div class="line">        <span class="keywordflow">for</span> desc <span class="keywordflow">in</span> depthMktDataDescriptions:</div><div class="line">            printinstance(desc)</div></div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="receive"></a>
Receiving</h1>
<p>Initially, all requested/available rows will be delivered to the client application. As market moves however these rows will inevitably change. To keep the client's order book consistent, the TWS will send updates not only informing which row is to be updated but also the operation to perform in the row: insert (0), update (1) or remove (2).</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl : EWrapper </div><div class="line">    {</div></div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> updateMktDepth(<span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> position, <span class="keywordtype">int</span> operation, <span class="keywordtype">int</span> side, <span class="keywordtype">double</span> price, <span class="keywordtype">int</span> size)</div><div class="line">        {</div><div class="line">            Console.WriteLine(<span class="stringliteral">&quot;UpdateMarketDepth. &quot;</span> + tickerId + <span class="stringliteral">&quot; - Position: &quot;</span> + position + <span class="stringliteral">&quot;, Operation: &quot;</span> + operation + <span class="stringliteral">&quot;, Side: &quot;</span> + side + <span class="stringliteral">&quot;, Price: &quot;</span> + price + <span class="stringliteral">&quot;, Size&quot;</span> + size);</div><div class="line">        }</div></div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> updateMktDepthL2(<span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> position, <span class="keywordtype">string</span> marketMaker, <span class="keywordtype">int</span> operation, <span class="keywordtype">int</span> side, <span class="keywordtype">double</span> price, <span class="keywordtype">int</span> size)</div><div class="line">        {</div><div class="line">            Console.WriteLine(<span class="stringliteral">&quot;UpdateMarketDepthL2. &quot;</span> + tickerId + <span class="stringliteral">&quot; - Position: &quot;</span> + position + <span class="stringliteral">&quot;, Operation: &quot;</span> + operation + <span class="stringliteral">&quot;, Side: &quot;</span> + side + <span class="stringliteral">&quot;, Price: &quot;</span> + price + <span class="stringliteral">&quot;, Size&quot;</span> + size);</div><div class="line">        }</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl <span class="keyword">implements</span> EWrapper {</div></div><!-- fragment --> ... <div class="fragment"><div class="line">    @Override</div><div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> updateMktDepth(<span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> position, <span class="keywordtype">int</span> operation,</div><div class="line">            <span class="keywordtype">int</span> side, <span class="keywordtype">double</span> price, <span class="keywordtype">int</span> size) {</div><div class="line">        <a class="code" href="namespaceSystem.html">System</a>.out.println(<span class="stringliteral">&quot;UpdateMarketDepth. &quot;</span>+tickerId+<span class="stringliteral">&quot; - Position: &quot;</span>+position+<span class="stringliteral">&quot;, Operation: &quot;</span>+operation+<span class="stringliteral">&quot;, Side: &quot;</span>+side+<span class="stringliteral">&quot;, Price: &quot;</span>+price+<span class="stringliteral">&quot;, Size: &quot;</span>+size+<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    }</div></div><!-- fragment --> ... <div class="fragment"><div class="line">    @Override</div><div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> updateMktDepthL2(<span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> position,</div><div class="line">            String marketMaker, <span class="keywordtype">int</span> operation, <span class="keywordtype">int</span> side, <span class="keywordtype">double</span> price, <span class="keywordtype">int</span> size) {</div><div class="line">        <a class="code" href="namespaceSystem.html">System</a>.out.println(<span class="stringliteral">&quot;UpdateMarketDepthL2. &quot;</span>+tickerId+<span class="stringliteral">&quot; - Position: &quot;</span>+position+<span class="stringliteral">&quot;, Operation: &quot;</span>+operation+<span class="stringliteral">&quot;, Side: &quot;</span>+side+<span class="stringliteral">&quot;, Price: &quot;</span>+price+<span class="stringliteral">&quot;, Size: &quot;</span>+size+<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    }</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Public Class EWrapperImpl</div><div class="line">        Implements EWrapper</div></div><!-- fragment --> ... <div class="fragment"><div class="line">        Public Sub updateMktDepth(tickerId As Integer, position As Integer, operation As Integer, side As Integer, price As Double, size As Integer) Implements IBApi.EWrapper.updateMktDepth</div><div class="line">            Console.WriteLine(&quot;UpdateMarketDepth. &quot; &amp; CStr(tickerId) &amp; &quot; - Position: &quot; &amp; CStr(position) &amp; &quot;, Operation: &quot; &amp; CStr(operation) &amp; &quot;, Side: &quot; &amp; CStr(side) &amp;</div><div class="line">                          &quot;, Price: &quot; &amp; CStr(price) &amp; &quot;, Size&quot; &amp; CStr(size))</div><div class="line">        End Sub</div></div><!-- fragment --> ... <div class="fragment"><div class="line">        Public Sub updateMktDepthL2(tickerId As Integer, position As Integer, marketMaker As String, operation As Integer, side As Integer, price As Double, size As Integer) Implements IBApi.EWrapper.updateMktDepthL2</div><div class="line">            Console.WriteLine(&quot;UpdateMarketDepthL2. &quot; &amp; tickerId &amp; &quot; - Position: &quot; &amp; position &amp; &quot;, Operation: &quot; &amp; operation &amp; &quot;, Side: &quot; &amp; side &amp;</div><div class="line">                          &quot;, Price: &quot; &amp; price &amp; &quot;, Size&quot; &amp; size)</div><div class="line">        End Sub</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestCppClient : <span class="keyword">public</span> EWrapper</div><div class="line">{</div></div><!-- fragment --> ... <div class="fragment"><div class="line"><span class="keywordtype">void</span> TestCppClient::updateMktDepth(TickerId <span class="keywordtype">id</span>, <span class="keywordtype">int</span> position, <span class="keywordtype">int</span> operation, <span class="keywordtype">int</span> side,</div><div class="line">                                   <span class="keywordtype">double</span> price, <span class="keywordtype">int</span> size) {</div><div class="line">    printf( <span class="stringliteral">&quot;UpdateMarketDepth. %ld - Position: %d, Operation: %d, Side: %d, Price: %g, Size: %d\n&quot;</span>, <span class="keywordtype">id</span>, position, operation, side, price, size);</div><div class="line">}</div></div><!-- fragment --> ... <div class="fragment"><div class="line"><span class="keywordtype">void</span> TestCppClient::updateMktDepthL2(TickerId <span class="keywordtype">id</span>, <span class="keywordtype">int</span> position, std::string marketMaker, <span class="keywordtype">int</span> operation,</div><div class="line">                                     <span class="keywordtype">int</span> side, <span class="keywordtype">double</span> price, <span class="keywordtype">int</span> size) {</div><div class="line">    printf( <span class="stringliteral">&quot;UpdateMarketDepthL2. %ld - Position: %d, Operation: %d, Side: %d, Price: %g, Size: %d\n&quot;</span>, <span class="keywordtype">id</span>, position, operation, side, price, size);</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestWrapper(wrapper.EWrapper):</div></div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="keyword">def </span>updateMktDepth(self, reqId: TickerId, position: int, operation: int,</div><div class="line">                       side: int, price: float, size: int):</div><div class="line">        super().updateMktDepth(reqId, position, operation, side, price, size)</div><div class="line">        print(<span class="stringliteral">&quot;UpdateMarketDepth. &quot;</span>, reqId, <span class="stringliteral">&quot;Position:&quot;</span>, position, <span class="stringliteral">&quot;Operation:&quot;</span>,</div><div class="line">              operation, <span class="stringliteral">&quot;Side:&quot;</span>, side, <span class="stringliteral">&quot;Price:&quot;</span>, price, <span class="stringliteral">&quot;Size&quot;</span>, size)</div><div class="line"></div></div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="keyword">def </span>updateMktDepthL2(self, reqId: TickerId, position: int, marketMaker: str,</div><div class="line">                         operation: int, side: int, price: float, size: int):</div><div class="line">        super().updateMktDepthL2(reqId, position, marketMaker, operation, side,</div><div class="line">                                 price, size)</div><div class="line">        print(<span class="stringliteral">&quot;UpdateMarketDepthL2. &quot;</span>, reqId, <span class="stringliteral">&quot;Position:&quot;</span>, position, <span class="stringliteral">&quot;Operation:&quot;</span>,</div><div class="line">              operation, <span class="stringliteral">&quot;Side:&quot;</span>, side, <span class="stringliteral">&quot;Price:&quot;</span>, price, <span class="stringliteral">&quot;Size&quot;</span>, size)</div><div class="line"></div></div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="canceling"></a>
Canceling</h1>
<p>To cancel an active market depth request simply invoke the <a class="el" href="classIBApi_1_1EClient.html#a7aeb4af9a757c70cb74579308ab1fb7b">IBApi.EClient.cancelMktDepth</a> passing in the request's identifier.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.cancelMktDepth(2001);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.cancelMktDepth(2001);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.cancelMktDepth(2001)</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;cancelMktDepth(2001);</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        self.cancelMktDepth(2101)</div><div class="line">        self.cancelMktDepth(2001)</div></div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="limitations"></a>
Limitations</h1>
<p>Given the potentially high amount of data being sent, market depth request's are much more limited. Just as with historical data requests, the amount of active depth requests is related to the amount of market data lines, with a minimum of three and maximum of 60:</p>
<table class="doxtable">
<tr>
<th>Number of lines</th><th>Max. Requests </th></tr>
<tr>
<td>0 - 399</td><td>3 </td></tr>
<tr>
<td>400 - 499</td><td>4 </td></tr>
<tr>
<td>500 - 599</td><td>5 </td></tr>
<tr>
<td>600 - 699</td><td>6 </td></tr>
<tr>
<td colspan="2">etc...  </td></tr>
</table>
<p><br />
<br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">This website uses cookies. By navigating through it you agree to the use of cookies. Copyright Interactive Brokers 2016 </li>
  </ul>
</div>
<!--BEGIN GCS_SEARCHBOX-->
<style type='text/css'>
	.gsc-control-cse{
		font family: Arial, sans-serif;
		border-color: #000100;
		background-color: #000000;
		width:260px;
		height: 20px;
		padding-top: 6px;
	}
	input.gsc-search-button {
		background-color: #6D1800;
		color: #fff;
		cursor: pointer;
	}
	input.gsc-search-button:hover {
		background-color: #A02200;
	}
	td.gsc-clear-button {
		position: relative;
		right: 85px;
	}
  }
</style>
<!--END GCS_SEARCHBOX-->
</body>
</html>
