<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>TWS API v9.72+: Dynamic Data Exchange</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="https://www.interactivebrokers.com/favicon.ico" rel="shortcut icon">
<script>
$(document).ready(function(){
		var picked=getCookie("picked");
		if (picked != "") {
			if (!$(this).hasClass("active")) {
				var tabNum = $(this).index();
				var nthChild = picked;
				$("ul#tabs li.active").removeClass("active");
				$(this).addClass("active");
				$("ul#tab li.active").removeClass("active");
				$("ul#tab li:nth-child("+nthChild+")").addClass("active");
				$("ul#tabs li:nth-child("+nthChild+")").addClass("active");
				setCookie("picked", nthChild, 1);
			}
		}
		$("ul#tabs li").click(function(e){
			if (!$(this).hasClass("active")) {
			var tabNum = $(this).index();
			var nthChild = tabNum+1;
			$("ul#tabs li.active").removeClass("active");
			$(this).addClass("active");
			$("ul#tab li.active").removeClass("active");
			$("ul#tab li:nth-child("+nthChild+")").addClass("active");
			setCookie("picked", nthChild, 1);
		}
    });
});
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
} 
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
} 
function checkCookie() {
    var picked=getCookie("picked");
    if (picked != "") {
        alert("Welcome again " + picked);
    }else{
        //username = prompt("Please enter your name:", "");
        if (picked != "" && picked != null) {
            setCookie("picked", 1, 365);
        }
    }
}
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ib_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></a></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li><li>Python</li></ul>
  </td>
  <!--BEGIN SS360 SEARCH-->
  <td>
	<div id="site-search-360" align="right" style="padding-left: 1em;">
		<input id="searchBox" type="search" placeholder="Search..." />
		<input id="ss360SearchButton" type="submit" />
	</div>
  </td>
  <!--END SS360 SEARCH-->
  <div id="contact-us" align="right">
	<td><a href="https://www.interactivebrokers.com/en/index.php?f=customerService&p=email" style="color:#C7C7C7;font-weight:bold;padding: 0 0 0 1em;">Contact us</a></td>
  </div>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dde_intro.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Dynamic Data Exchange </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Dynamic Data Exchange protocol is a method of inter-process communication developed by Microsoft to establish communication between Windows applications running on the same computer. The DDE API is available for Windows computers to create a means of communication between Microsoft Excel and TWS or IB Gateway.</p>
<p><b>Requirements for the DDE API</b></p>
<ul>
<li>Windows OS</li>
<li><b>32 bit version</b> of TWS or IB Gateway</li>
<li>Microsoft Excel</li>
<li>TWS API installed to the C: drive</li>
<li>Excel must be set to the US settings for commas and periods. That is, commas denote thousands and periods denote decimals.</li>
</ul>
<p>Interactive Brokers does not offer any programming assistance and therefore it is strongly advised to anyone willing to use any of the TWS DDE API to become familiar with the technologies involved such as the DDE protocol and VBA.</p>
<p>You can get started by following the <a class="el" href="dde_tutorial.html">Tutorial</a> and learn how to use DDE to communicate with TWS.</p>
<p><b>Limitations specific to DDE</b></p>
<ul>
<li>DDE does not have the full range of tick types available to the socket-based APIs</li>
<li>DDE requires live market data in TWS to receive any market data. It is not compatible with delayed data.</li>
<li>Other applications running DDE in the background can interfere with Excel DDE and cannot be used simultaneously.</li>
</ul>
<h1><a class="anchor" id="dde_issues"></a>
Troubleshooting Excel DDE</h1>
<ul>
<li><b>Error: "Remote Data Not Accessible..." causes</b></li>
</ul>
<p>When this error is encountered in using a DDE formula in an Excel spreadsheet it indicates a general problem in the DDE connection between Excel and TWS. This can have any of the following causes:</p>
<ul>
<li><b>1)</b> TWS is not 32 bit. By default 64 bit TWS is installed on modern computers. It is necessary to select the 32 bit version when downloading to use the DDE API.</li>
<li><b>2)</b> The API is not installed to the C: drive. The API can be downloaded from <a href="http://interactivebrokers.github.io/">http://interactivebrokers.github.io/</a> . After installation, there should be a folder "TWS API" on the C: drive. If the API installs to any other drive this can cause issues.</li>
<li><b>3)</b> "Enable DDE" is not checked in the TWS (or IB Gateway Global Configuration). In TWS this setting is at Global Configuration -&gt; API -&gt; Settings -&gt; "Enable DDE".</li>
<li><b>4)</b> The incorrect username is input into a formula in Excel. The username in the spreadsheet must match the username used to login to TWS. For paper accounts, it must be the paper account username and not the live username (every paper account has a distinct username).</li>
</ul>
<p><b>(5)</b> In rare cases it is necessary to run Excel as Administrator to use DDE.</p>
<p><b>Note:</b> Other programs running on the same computer which use DDE can interfere with the communication between Excel and TWS and cause Excel to 'hang' or 'freeze' after making the initial request. The only solution to this problem is to close other programs using DDE one-by-one to find the culprit. Programs which are known to cause this issue include Google Chrome, Microsoft OneNote, Skype and Adobe Creative Cloud.</p>
<ul>
<li>The DDE API is now considered completed and will not have additional functionality that is added to socket-based APIs.</li>
</ul>
<h1><a class="anchor" id="excel_limitations"></a>
Limitations of Microsoft Excel</h1>
<p>By design, Microsoft Excel gives precedence to the user interface over the data connection to other applications. For that reason, Excel only receives updates when it is in a 'ready' state, and may ignore data sent for instance when a modal dialogue box is displayed to the user, a cell is being edited, or Excel is busy doing other things. A new Excel Real Time Data server (RTD) API is being introduced to help address some of these deficiencies, but unfortunately these limitations are inherent to Excel as a trading application and not specific to an API technology.</p>
<p><br/>
<br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">This website uses cookies. By navigating through it you agree to the use of cookies. Copyright Interactive Brokers 2016 </li>
  </ul>
</div>
<!--BEGIN !SS360 SEARCH-->
<script>
var ss360Config = {
    /********* General *********/
    siteId: 'tws-api-doc',
    animationSpeed: 250,
    themeColor: '#A02424',
    showErrors: false,
    /********* Search Box *********/
    searchBoxSelector: '#searchBox',
    searchBoxStyle: {
        text: {
            color: '#ffffff',
            size: '12px',
        },
        background: {
            color: '#000000',
        },
        padding: '8px',        
        icon: {
            image: undefined,
        },
        border: {
            color: '#464646',
            radius: '7px',
        },
        button: {
            text: ' ',
            icon: 'magnifier'
        }
    },
    placeholder: 'Search...',
    searchButton: '#ss360SearchButton',
    /********* Search Suggestions *********/
    showSearchSuggestions: true,
    suggestionsStyle: {
        text: {
            color: '#333333',
        },
        background: {
            color: '#ffffff'
        },
        padding: '10px',
        distanceFromTop: '7px',
        border: {
            color: '#dddddd',
            radius: '7px',
        },
    },
    showImagesSuggestions: true,
    numSuggestions: 6,
    maxQuerySuggestions: 3,
    minChars: 3,
    highlight: true,
    /********* Search Results *********/
    searchResults: undefined,
    searchResultsCaption: 'We found #COUNT# results for your query "#QUERY#"',
    numResults: 50,
    navigation: 'top',
    highlightQueryTerms: true,
    showImagesResults: true,
    showResultLink: true,
    resultLinksOpenNewTab: false,
    queryCorrectionText: 'Did you mean "#CORRECTION#"?',
    noResultsText: 'Sorry, we have not found any matches for your query.',
    otherContentGroupName: 'Other',
    ignoreOtherContentGroup: false,
    moreResultsButton: undefined,
    moreResultsPagingSize: 50,
    groupResults: true,
    loader: {
        type: 'circle'
    }
}
</script>
<script src="https://sitesearch360.com/cdn/sitesearch360-v10.min.js"></script>
<!--END !SS360 SEARCH-->
</body>
</html>
