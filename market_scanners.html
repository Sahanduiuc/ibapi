<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>TWS API v9.72+: Market Scanners</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="https://www.interactivebrokers.com/favicon.ico" rel="shortcut icon">
<script>
$(document).ready(function(){
		var picked=getCookie("picked");
		if (picked != "") {
			if (!$(this).hasClass("active")) {
				var tabNum = $(this).index();
				var nthChild = picked;
				$("ul#tabs li.active").removeClass("active");
				$(this).addClass("active");
				$("ul#tab li.active").removeClass("active");
				$("ul#tab li:nth-child("+nthChild+")").addClass("active");
				$("ul#tabs li:nth-child("+nthChild+")").addClass("active");
				setCookie("picked", nthChild, 1);
			}
		}
		$("ul#tabs li").click(function(e){
			if (!$(this).hasClass("active")) {
			var tabNum = $(this).index();
			var nthChild = tabNum+1;
			$("ul#tabs li.active").removeClass("active");
			$(this).addClass("active");
			$("ul#tab li.active").removeClass("active");
			$("ul#tab li:nth-child("+nthChild+")").addClass("active");
			setCookie("picked", nthChild, 1);
		}
    });
});
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
} 
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
} 
function checkCookie() {
    var picked=getCookie("picked");
    if (picked != "") {
        alert("Welcome again " + picked);
    }else{
        //username = prompt("Please enter your name:", "");
        if (picked != "" && picked != null) {
            setCookie("picked", 1, 365);
        }
    }
}
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ib_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></a></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li><li>Python</li></ul>
  </td>
  <td><a href="https://www.interactivebrokers.com/en/index.php?f=customerService&p=email" style="color:#C7C7C7;font-weight:bold;padding: 0 0 0 1em;">Contact us</a></td>
  <!--BEGIN GCS_SEARCHBOX-->
  <td style="position: absolute; right: 0;">
   <div id="google-custom-search" align="right" style="vertical-align: top;">
   <script>
  (function() {
    var cx = '015239726745168389685:6_uymb577ei';
	var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
	</script>
	<gcse:search newWindow="false" enableHistory="true"></gcse:search>
   </div>
   </td>
  <!--END !GCS_SEARCHBOX-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('market_scanners.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Market Scanners </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Some scans in the TWS <a href="https://www.interactivebrokers.com/en/software/webtrader/webtrader/marketscanners/market%20scanners.htm" target="_blank" class="linkexternal">Advanced Market Scanner</a> can be accessed via the TWS API through the <a class="el" href="classIBApi_1_1EClient.html#a13dd1287f67c6873b3e8b85d6c19f885">IBApi.EClient.reqScannerSubscription</a>.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.reqScannerSubscription(7001, ScannerSubscriptionSamples.HighOptVolumePCRatioUSIndexes(), null);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.reqScannerSubscription(7001, ScannerSubscriptionSamples.HighOptVolumePCRatioUSIndexes(), null);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.reqScannerSubscription(7001, ScannerSubscriptionSamples.HighOptVolumePCRatioUSIndexes(), Nothing)</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;reqScannerSubscription(7001, ScannerSubscriptionSamples::HotUSStkByVolume(), TagValueListSPtr());</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        self.reqScannerSubscription(7001,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;                                    ScannerSubscriptionSamples.HighOptVolumePCRatioUSIndexes(), [])</div>
</div><!-- fragment -->  </li>
</ul>
<p>The available API filters and and parameters are defined in the <a class="el" href="classIBApi_1_1ScannerSubscription.html">IBApi.ScannerSubscription</a> object, including [AbovePrice, BelowPrice, AboveVolume, ...] . Some <a class="el" href="market_scanners.html#scanner_examples">Market Scanner Examples</a> are listed at the bottom of this page.</p>
<p>Scans are limited to a maximum result of 50 results per scan code, and only 10 API scans can be active at a time.</p>
<p>Results are delivered via <a class="el" href="interfaceIBApi_1_1EWrapper.html#a973d71a29aa397fc21f51113b1a12461">IBApi.EWrapper.scannerData</a> and the <a class="el" href="interfaceIBApi_1_1EWrapper.html#a54d829186800287ac87c77a6a38a1917">IBApi.EWrapper.scannerDataEnd</a> marker will indicate when all results have been delivered. The returned results to scannerData simply consist of a list of contracts. There are no market data fields (bid, ask, last, volume, ...) returned from the scanner, and so if these are desired they have to be requested separately with the reqMktData function. Since the scanner results do not include any market data fields, it is not necessary to have market data subscriptions to use the API scanner. However to use filters, market data subscriptions <b>are</b> generally required.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl : EWrapper </div>
<div class="line">    {</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> scannerData(<span class="keywordtype">int</span> reqId, <span class="keywordtype">int</span> rank, ContractDetails contractDetails, <span class="keywordtype">string</span> distance, <span class="keywordtype">string</span> benchmark, <span class="keywordtype">string</span> projection, <span class="keywordtype">string</span> legsStr)</div>
<div class="line">        {</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;ScannerData. &quot;</span>+reqId+<span class="stringliteral">&quot; - Rank: &quot;</span>+rank+<span class="stringliteral">&quot;, Symbol: &quot;</span>+contractDetails.Summary.Symbol+<span class="stringliteral">&quot;, SecType: &quot;</span>+contractDetails.Summary.SecType+<span class="stringliteral">&quot;, Currency: &quot;</span>+contractDetails.Summary.Currency</div>
<div class="line">                +<span class="stringliteral">&quot;, Distance: &quot;</span>+distance+<span class="stringliteral">&quot;, Benchmark: &quot;</span>+benchmark+<span class="stringliteral">&quot;, Projection: &quot;</span>+projection+<span class="stringliteral">&quot;, Legs String: &quot;</span>+legsStr);</div>
<div class="line">        }</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> scannerDataEnd(<span class="keywordtype">int</span> reqId)</div>
<div class="line">        {</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;ScannerDataEnd. &quot;</span>+reqId);</div>
<div class="line">        }</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl <span class="keyword">implements</span> EWrapper {</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">    @Override</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> scannerData(<span class="keywordtype">int</span> reqId, <span class="keywordtype">int</span> rank,</div>
<div class="line">            ContractDetails contractDetails, String distance, String benchmark,</div>
<div class="line">            String projection, String legsStr) {</div>
<div class="line">        System.out.println(<span class="stringliteral">&quot;ScannerData. &quot;</span>+reqId+<span class="stringliteral">&quot; - Rank: &quot;</span>+rank+<span class="stringliteral">&quot;, Symbol: &quot;</span>+contractDetails.contract().symbol()+<span class="stringliteral">&quot;, SecType: &quot;</span>+contractDetails.contract().secType()+<span class="stringliteral">&quot;, Currency: &quot;</span>+contractDetails.contract().currency()</div>
<div class="line">                +<span class="stringliteral">&quot;, Distance: &quot;</span>+distance+<span class="stringliteral">&quot;, Benchmark: &quot;</span>+benchmark+<span class="stringliteral">&quot;, Projection: &quot;</span>+projection+<span class="stringliteral">&quot;, Legs String: &quot;</span>+legsStr);</div>
<div class="line">    }</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">    @Override</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> scannerDataEnd(<span class="keywordtype">int</span> reqId) {</div>
<div class="line">        System.out.println(<span class="stringliteral">&quot;ScannerDataEnd. &quot;</span>+reqId);</div>
<div class="line">    }</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Public Class EWrapperImpl</div>
<div class="line">        Implements EWrapper</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        Public Sub scannerData(reqId As Integer, rank As Integer, contractDetails As IBApi.ContractDetails, distance As String, benchmark As String, projection As String, legsStr As String) Implements IBApi.EWrapper.scannerData</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;ScannerData. &quot;</span> &amp; reqId &amp; <span class="stringliteral">&quot; - Rank: &quot;</span> &amp; rank &amp; <span class="stringliteral">&quot;, Symbol: &quot;</span> &amp; contractDetails.Summary.Symbol &amp; <span class="stringliteral">&quot;, SecType: &quot;</span> &amp;</div>
<div class="line">                          contractDetails.Summary.SecType &amp; <span class="stringliteral">&quot;, Currency: &quot;</span> &amp; contractDetails.Summary.Currency &amp; <span class="stringliteral">&quot;, Distance: &quot;</span> &amp; distance &amp;</div>
<div class="line">                          <span class="stringliteral">&quot;, Benchmark: &quot;</span> &amp; benchmark &amp; <span class="stringliteral">&quot;, Projection: &quot;</span> &amp; projection &amp; <span class="stringliteral">&quot;, Legs String: &quot;</span> &amp; legsStr)</div>
<div class="line">        End Sub</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        Public Sub scannerDataEnd(reqId As Integer) Implements IBApi.EWrapper.scannerDataEnd</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;ScannerDataEnd. &quot;</span> &amp; reqId &amp; <span class="stringliteral">&quot;\n&quot;</span>)</div>
<div class="line">        End Sub</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestCppClient : <span class="keyword">public</span> EWrapper</div>
<div class="line">{</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><span class="keywordtype">void</span> TestCppClient::scannerData(<span class="keywordtype">int</span> reqId, <span class="keywordtype">int</span> rank, <span class="keyword">const</span> ContractDetails&amp; contractDetails,</div>
<div class="line">                                <span class="keyword">const</span> std::string&amp; distance, <span class="keyword">const</span> std::string&amp; benchmark, <span class="keyword">const</span> std::string&amp; projection,</div>
<div class="line">                                <span class="keyword">const</span> std::string&amp; legsStr) {</div>
<div class="line">    printf( <span class="stringliteral">&quot;ScannerData. %d - Rank: %d, Symbol: %s, SecType: %s, Currency: %s, Distance: %s, Benchmark: %s, Projection: %s, Legs String: %s\n&quot;</span>, reqId, rank, contractDetails.summary.symbol.c_str(), contractDetails.summary.secType.c_str(), contractDetails.summary.currency.c_str(), distance.c_str(), benchmark.c_str(), projection.c_str(), legsStr.c_str());</div>
<div class="line">}</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><span class="keywordtype">void</span> TestCppClient::scannerDataEnd(<span class="keywordtype">int</span> reqId) {</div>
<div class="line">    printf( <span class="stringliteral">&quot;ScannerDataEnd. %d\n&quot;</span>, reqId);</div>
<div class="line">}</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">class </span>TestWrapper(wrapper.EWrapper):</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;    <span class="keyword">def </span>scannerData(self, reqId: int, rank: int, contractDetails: ContractDetails,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;                    distance: str, benchmark: str, projection: str, legsStr: str):</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        super().scannerData(reqId, rank, contractDetails, distance, benchmark,</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;                            projection, legsStr)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        print(<span class="stringliteral">&quot;ScannerData. &quot;</span>, reqId, <span class="stringliteral">&quot;Rank:&quot;</span>, rank, <span class="stringliteral">&quot;Symbol:&quot;</span>, contractDetails.summary.symbol,</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;              <span class="stringliteral">&quot;SecType:&quot;</span>, contractDetails.summary.secType,</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;              <span class="stringliteral">&quot;Currency:&quot;</span>, contractDetails.summary.currency,</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;              <span class="stringliteral">&quot;Distance:&quot;</span>, distance, <span class="stringliteral">&quot;Benchmark:&quot;</span>, benchmark,</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;              <span class="stringliteral">&quot;Projection:&quot;</span>, projection, <span class="stringliteral">&quot;Legs String:&quot;</span>, legsStr)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;    <span class="keyword">def </span>scannerDataEnd(self, reqId: int):</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        super().scannerDataEnd(reqId)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        print(<span class="stringliteral">&quot;ScannerDataEnd. &quot;</span>, reqId)</div>
</div><!-- fragment -->  </li>
</ul>
<p>Since the <a class="el" href="classIBApi_1_1EClient.html#a13dd1287f67c6873b3e8b85d6c19f885">IBApi.EClient.reqScannerSubscription</a> request keeps a subscription open you will keep receiving periodic updates until the request is cancelled via <a class="el" href="classIBApi_1_1EClient.html#abf7a8fc280a422a0695962ba50b2d574">IBApi.EClient.cancelScannerSubscription</a> :</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.cancelScannerSubscription(7001);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.cancelScannerSubscription(7001);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.cancelScannerSubscription(7001)</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;cancelScannerSubscription(7001);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        self.cancelScannerSubscription(7001)</div>
</div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="scanner_examples"></a>
Market Scanner Examples</h1>
<p>The available API scans are defined by the fields in the ScannerSubscription object, i.e. <em>abovePrice, aboveVolume, belowPrice</em>, etc. Some market scanner examples are below.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            <span class="comment">//Hot US stocks by volume</span></div>
<div class="line">            ScannerSubscription scanSub = <span class="keyword">new</span> ScannerSubscription();</div>
<div class="line">            scanSub.Instrument = <span class="stringliteral">&quot;STK&quot;</span>;</div>
<div class="line">            scanSub.LocationCode = <span class="stringliteral">&quot;STK.US.MAJOR&quot;</span>;</div>
<div class="line">            scanSub.ScanCode = <span class="stringliteral">&quot;HOT_BY_VOLUME&quot;</span>;</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">            <span class="comment">//Top % gainers at IBIS</span></div>
<div class="line">            ScannerSubscription scanSub = <span class="keyword">new</span> ScannerSubscription();</div>
<div class="line">            scanSub.Instrument = <span class="stringliteral">&quot;STOCK.EU&quot;</span>;</div>
<div class="line">            scanSub.LocationCode = <span class="stringliteral">&quot;STK.EU.IBIS&quot;</span>;</div>
<div class="line">            scanSub.ScanCode = <span class="stringliteral">&quot;TOP_PERC_GAIN&quot;</span>;</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">            <span class="comment">//Most active futures at SOFFEX</span></div>
<div class="line">            ScannerSubscription scanSub = <span class="keyword">new</span> ScannerSubscription();</div>
<div class="line">            scanSub.Instrument = <span class="stringliteral">&quot;FUT.EU&quot;</span>;</div>
<div class="line">            scanSub.LocationCode = <span class="stringliteral">&quot;FUT.EU.SOFFEX&quot;</span>;</div>
<div class="line">            scanSub.ScanCode = <span class="stringliteral">&quot;MOST_ACTIVE&quot;</span>;</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">            <span class="comment">//High option volume P/C ratio US indexes</span></div>
<div class="line">            ScannerSubscription scanSub = <span class="keyword">new</span> ScannerSubscription();</div>
<div class="line">            scanSub.Instrument = <span class="stringliteral">&quot;IND.US&quot;</span>;</div>
<div class="line">            scanSub.LocationCode = <span class="stringliteral">&quot;IND.US&quot;</span>;</div>
<div class="line">            scanSub.ScanCode = <span class="stringliteral">&quot;HIGH_OPT_VOLUME_PUT_CALL_RATIO&quot;</span>;</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        <span class="comment">//Hot US stocks by volume</span></div>
<div class="line">        ScannerSubscription scanSub = <span class="keyword">new</span> ScannerSubscription();</div>
<div class="line">        scanSub.instrument(<span class="stringliteral">&quot;STK&quot;</span>);</div>
<div class="line">        scanSub.locationCode(<span class="stringliteral">&quot;STK.US.MAJOR&quot;</span>);</div>
<div class="line">        scanSub.scanCode(<span class="stringliteral">&quot;HOT_BY_VOLUME&quot;</span>);</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="comment">//Top % gainers at IBIS</span></div>
<div class="line">        ScannerSubscription scanSub = <span class="keyword">new</span> ScannerSubscription();</div>
<div class="line">        scanSub.instrument(<span class="stringliteral">&quot;STOCK.EU&quot;</span>);</div>
<div class="line">        scanSub.locationCode(<span class="stringliteral">&quot;STK.EU.IBIS&quot;</span>);</div>
<div class="line">        scanSub.scanCode(<span class="stringliteral">&quot;TOP_PERC_GAIN&quot;</span>);</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="comment">//Most active futures at SOFFEX</span></div>
<div class="line">        ScannerSubscription scanSub = <span class="keyword">new</span> ScannerSubscription();</div>
<div class="line">        scanSub.instrument(<span class="stringliteral">&quot;FUT.EU&quot;</span>);</div>
<div class="line">        scanSub.locationCode(<span class="stringliteral">&quot;FUT.EU.SOFFEX&quot;</span>);</div>
<div class="line">        scanSub.scanCode(<span class="stringliteral">&quot;MOST_ACTIVE&quot;</span>);</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="comment">//High option volume P/C ratio US indexes</span></div>
<div class="line">        ScannerSubscription scanSub = <span class="keyword">new</span> ScannerSubscription();</div>
<div class="line">        scanSub.instrument(<span class="stringliteral">&quot;IND.US&quot;</span>);</div>
<div class="line">        scanSub.locationCode(<span class="stringliteral">&quot;IND.US&quot;</span>);</div>
<div class="line">        scanSub.scanCode(<span class="stringliteral">&quot;HIGH_OPT_VOLUME_PUT_CALL_RATIO&quot;</span>);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">            <span class="stringliteral">&#39;Hot US stocks by volume</span></div>
<div class="line"><span class="stringliteral">            Dim scanSub As ScannerSubscription = New ScannerSubscription()</span></div>
<div class="line"><span class="stringliteral">            scanSub.Instrument = &quot;STK&quot;</span></div>
<div class="line"><span class="stringliteral">            scanSub.LocationCode = &quot;STK.US.MAJOR&quot;</span></div>
<div class="line"><span class="stringliteral">            scanSub.ScanCode = &quot;HOT_BY_VOLUME&quot;</span></div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">            <span class="stringliteral">&#39;Top % gainers at IBIS</span></div>
<div class="line"><span class="stringliteral">            Dim scanSub As ScannerSubscription = New ScannerSubscription()</span></div>
<div class="line"><span class="stringliteral">            scanSub.Instrument = &quot;STOCK.EU&quot;</span></div>
<div class="line"><span class="stringliteral">            scanSub.LocationCode = &quot;STK.EU.IBIS&quot;</span></div>
<div class="line"><span class="stringliteral">            scanSub.ScanCode = &quot;TOP_PERC_GAIN&quot;</span></div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">            <span class="stringliteral">&#39;Most active futures at SOFFEX</span></div>
<div class="line"><span class="stringliteral">            Dim scanSub As ScannerSubscription = New ScannerSubscription()</span></div>
<div class="line"><span class="stringliteral">            scanSub.Instrument = &quot;FUT.EU&quot;</span></div>
<div class="line"><span class="stringliteral">            scanSub.LocationCode = &quot;FUT.EU.SOFFEX&quot;</span></div>
<div class="line"><span class="stringliteral">            scanSub.ScanCode = &quot;MOST_ACTIVE&quot;</span></div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">            <span class="stringliteral">&#39;High option volume P/C ratio US indexes</span></div>
<div class="line"><span class="stringliteral">            Dim scanSub As ScannerSubscription = New ScannerSubscription()</span></div>
<div class="line"><span class="stringliteral">            scanSub.Instrument = &quot;IND.US&quot;</span></div>
<div class="line"><span class="stringliteral">            scanSub.LocationCode = &quot;IND.US&quot;</span></div>
<div class="line"><span class="stringliteral">            scanSub.ScanCode = &quot;HIGH_OPT_VOLUME_PUT_CALL_RATIO&quot;</span></div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    <span class="comment">//Hot US stocks by volume</span></div>
<div class="line">    ScannerSubscription scanSub;</div>
<div class="line">    scanSub.instrument = <span class="stringliteral">&quot;STK&quot;</span>;</div>
<div class="line">    scanSub.locationCode = <span class="stringliteral">&quot;STK.US.MAJOR&quot;</span>;</div>
<div class="line">    scanSub.scanCode = <span class="stringliteral">&quot;HOT_BY_VOLUME&quot;</span>;</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="comment">//Top % gainers at IBIS</span></div>
<div class="line">    ScannerSubscription scanSub;</div>
<div class="line">    scanSub.instrument = <span class="stringliteral">&quot;STOCK.EU&quot;</span>;</div>
<div class="line">    scanSub.locationCode = <span class="stringliteral">&quot;STK.EU.IBIS&quot;</span>;</div>
<div class="line">    scanSub.scanCode = <span class="stringliteral">&quot;TOP_PERC_GAIN&quot;</span>;</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="comment">//Most active futures at SOFFEX</span></div>
<div class="line">    ScannerSubscription scanSub;</div>
<div class="line">    scanSub.instrument = <span class="stringliteral">&quot;FUT.EU&quot;</span>;</div>
<div class="line">    scanSub.locationCode = <span class="stringliteral">&quot;FUT.EU.SOFFEX&quot;</span>;</div>
<div class="line">    scanSub.scanCode = <span class="stringliteral">&quot;MOST_ACTIVE&quot;</span>;</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="comment">//High option volume P/C ratio US indexes</span></div>
<div class="line">    ScannerSubscription scanSub;</div>
<div class="line">    scanSub.instrument = <span class="stringliteral">&quot;IND.US&quot;</span>;</div>
<div class="line">    scanSub.locationCode = <span class="stringliteral">&quot;IND.US&quot;</span>;</div>
<div class="line">    scanSub.scanCode = <span class="stringliteral">&quot;HIGH_OPT_VOLUME_PUT_CALL_RATIO&quot;</span>;</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        <span class="comment">#Hot US stocks by volume</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        scanSub = ScannerSubscription()</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        scanSub.instrument = <span class="stringliteral">&quot;STK&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        scanSub.locationCode = <span class="stringliteral">&quot;STK.US.MAJOR&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        scanSub.scanCode = <span class="stringliteral">&quot;HOT_BY_VOLUME&quot;</span></div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        <span class="comment"># Top % gainers at IBIS</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        scanSub = ScannerSubscription()</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        scanSub.instrument = <span class="stringliteral">&quot;STOCK.EU&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        scanSub.locationCode = <span class="stringliteral">&quot;STK.EU.IBIS&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        scanSub.scanCode = <span class="stringliteral">&quot;TOP_PERC_GAIN&quot;</span></div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        <span class="comment"># Most active futures at SOFFEX</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        scanSub = ScannerSubscription()</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        scanSub.instrument = <span class="stringliteral">&quot;FUT.EU&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        scanSub.locationCode = <span class="stringliteral">&quot;FUT.EU.SOFFEX&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        scanSub.scanCode = <span class="stringliteral">&quot;MOST_ACTIVE&quot;</span></div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        <span class="comment"># High option volume P/C ratio US indexes</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        scanSub = ScannerSubscription()</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        scanSub.instrument = <span class="stringliteral">&quot;IND.US&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        scanSub.locationCode = <span class="stringliteral">&quot;IND.US&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        scanSub.scanCode = <span class="stringliteral">&quot;HIGH_OPT_VOLUME_PUT_CALL_RATIO&quot;</span></div>
</div><!-- fragment -->  </li>
</ul>
<p>See also <a class="el" href="scanner_parameters.html">Scanner Parameters</a></p>
<p><br/>
<br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">This website uses cookies. By navigating through it you agree to the use of cookies. Copyright Interactive Brokers 2016 </li>
  </ul>
</div>
<!--BEGIN GCS_SEARCHBOX-->
<style type='text/css'>
	.gsc-control-cse{
		font family: Arial, sans-serif;
		border-color: #000100;
		background-color: #000000;
		width:260px;
		height: 20px;
		padding-top: 6px;
	}
	input.gsc-search-button {
		background-color: #6D1800;
		color: #fff;
		cursor: pointer;
	}
	input.gsc-search-button:hover {
		background-color: #A02200;
	}
	td.gsc-clear-button {
		position: relative;
		right: 85px;
	}
  }
</style>
<!--END GCS_SEARCHBOX-->
</body>
</html>
